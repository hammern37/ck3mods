namespace = lifestyle_experience_xp

lifestyle_experience_xp.001 = {
	hidden = yes
	immediate = {
		set_variable = {
			name = lsxp_game_rule_modifier
			value = {
				value = 1
				if = {
					limit = {
						has_game_rule = small_bonus
					}
					add = 0.5
				}
				if = {
					limit = {
						has_game_rule = medium_bonus
					}
					add = 1
				}
				if = {
					limit = {
						has_game_rule = big_bonus
					}
					add = 2
				}
				if = {
					limit = {
						has_game_rule = huge_bonus
					}
					add = 3
				}
			}
		}

		if = {
			limit = {
				NOT = { has_game_rule = lsxp_ceiling_none }
			}
			set_variable = {
				name = lsxp_skill_ceiling
				value = {
					value = 0
					if = {
						limit = {
							has_game_rule = lsxp_ceiling_25
						}
						add = 25
					}
					if = {
						limit = {
							has_game_rule = lsxp_ceiling_30
						}
						add = 30
					}
					if = {
						limit = {
							has_game_rule = lsxp_ceiling_50
						}
						add = 50
					}
					if = {
						limit = {
							has_game_rule = lsxp_ceiling_100
						}
						add = 100
					}
				}
			}
		}

		set_variable = {
			name = lsxp_skill_floor
			value = {
				value = 0
				if = {
					limit = {
						has_game_rule = lsxp_floor_5
					}
					add = -5
				}
				if = {
					limit = {
						has_game_rule = lsxp_floor_10
					}
					add = -10
				}
			}
		}
		#general multiplier from intelligence
		set_variable = {
			name = lsxp_general_multiplier
			value = {
				value = 1
				if = {
					limit = { has_trait = intellect_bad_1 }
					add = -0.1
				}
				if = {
					limit = { has_trait = intellect_bad_2 }
					add = -0.2
				}
				if = {
					limit = { has_trait = intellect_bad_3 }
					add = -0.3
				}
				if = {
					limit = { has_trait = intellect_good_1 }
					add = 0.1
				}
				if = {
					limit = { has_trait = intellect_good_2 }
					add = 0.2
				}
				if = {
					limit = { has_trait = intellect_good_3 }
					add = 0.3
				}
			}
		}
		#multipliers for specific lifestyles
		set_variable = { #diplomacy education var
			name = lsxp_diplomacy_multiplier
			value = {
				value = var:lsxp_general_multiplier
				if = {
					limit = { has_trait = education_diplomacy_1 }
					add = 0.1
				}
				if = {
					limit = { has_trait = education_diplomacy_2 }
					add = 0.2
				}
				if = {
					limit = { has_trait = education_diplomacy_3 }
					add = 0.3
				}
				if = {
					limit = { has_trait = education_diplomacy_4 }
					add = 0.4
				}
				if = {
					limit = {
						has_trait = diplomat
						has_trait = august
						has_trait = family_first
					}
					multiply = 0
				}
			}
		}
		set_variable = { #martial education var
			name = lsxp_martial_multiplier
			value = {
				value = var:lsxp_general_multiplier
				if = {
					limit = { has_trait = education_martial_1 }
					add = 0.1
				}
				if = {
					limit = { has_trait = education_martial_2 }
					add = 0.2
				}
				if = {
					limit = { has_trait = education_martial_3 }
					add = 0.3
				}
				if = {
					limit = { has_trait = education_martial_4 }
					add = 0.4
				}
				if = {
					limit = {
						has_trait = strategist
						has_trait = overseer
						has_trait = gallant
					}
					multiply = 0
				}
			}
		}

		set_variable = { #stewardship education var
			name = lsxp_stewardship_multiplier
			value = {
				value = var:lsxp_general_multiplier
				if = {
					limit = { has_trait = education_stewardship_1 }
					add = 0.1
				}
				if = {
					limit = { has_trait = education_stewardship_2 }
					add = 0.2
				}
				if = {
					limit = { has_trait = education_stewardship_3 }
					add = 0.3
				}
				if = {
					limit = { has_trait = education_stewardship_4 }
					add = 0.4
				}
				if = {
					limit = {
						has_trait = avaricious
						has_trait = architect
						has_trait = administrator
					}
					multiply = 0
				}
			}
		}
		set_variable = { #intrigue education var
			name = lsxp_intrigue_multiplier
			value = {
				value = var:lsxp_general_multiplier
				if = {
					limit = { has_trait = education_intrigue_1 }
					add = 0.1
				}
				if = {
					limit = { has_trait = education_intrigue_2 }
					add = 0.2
				}
				if = {
					limit = { has_trait = education_intrigue_3 }
					add = 0.3
				}
				if = {
					limit = { has_trait = education_intrigue_4 }
					add = 0.4
				}
				if = {
					limit = {
						has_trait = schemer
						has_trait = seducer
						has_trait = torturer
					}
					multiply = 0
				}
			}
		}
		set_variable = { #learning education var
			name = lsxp_learning_multiplier
			value = {
				value = var:lsxp_general_multiplier
				if = {
					limit = { has_trait = education_learning_1 }
					add = 0.1
				}
				if = {
					limit = { has_trait = education_learning_2 }
					add = 0.2
				}
				if = {
					limit = { has_trait = education_learning_3 }
					add = 0.3
				}
				if = {
					limit = { has_trait = education_learning_4 }
					add = 0.4
				}
				if = {
					limit = {
						has_trait = whole_of_body
						has_trait = scholar
						has_trait = theologian
					}
					multiply = 0
				}
			}
		}

		#XP GIVEAWAY!
		add_diplomacy_lifestyle_xp = {
			value = diplomacy
			if = {
				limit = {
					NOT = { has_game_rule = lsxp_ceiling_none }
				}
				max = var:lsxp_skill_ceiling
			}
			add = var:lsxp_skill_floor
			multiply = var:lsxp_diplomacy_multiplier
			multiply = var:lsxp_game_rule_modifier
		}
		add_martial_lifestyle_xp = {
			value = martial
			if = {
				limit = {
					NOT = { has_game_rule = lsxp_ceiling_none }
				}
				max = var:lsxp_skill_ceiling
			}
			add = var:lsxp_skill_floor
			multiply = var:lsxp_martial_multiplier
			multiply = var:lsxp_game_rule_modifier
		}
		add_stewardship_lifestyle_xp = {
			value = stewardship
			if = {
				limit = {
					NOT = { has_game_rule = lsxp_ceiling_none }
				}
				max = var:lsxp_skill_ceiling
			}
			add = var:lsxp_skill_floor
			multiply = var:lsxp_stewardship_multiplier
			multiply = var:lsxp_game_rule_modifier
		}
		add_intrigue_lifestyle_xp = {
			value = intrigue
			if = {
				limit = {
					NOT = { has_game_rule = lsxp_ceiling_none }
				}
				max = var:lsxp_skill_ceiling
			}
			add = var:lsxp_skill_floor
			multiply = var:lsxp_intrigue_multiplier
			multiply = var:lsxp_game_rule_modifier
		}
		add_learning_lifestyle_xp = {
			value = learning
			if = {
				limit = {
					NOT = { has_game_rule = lsxp_ceiling_none }
				}
				max = var:lsxp_skill_ceiling
			}
			add = var:lsxp_skill_floor
			multiply = var:lsxp_learning_multiplier
			multiply = var:lsxp_game_rule_modifier
		}
	}
}
