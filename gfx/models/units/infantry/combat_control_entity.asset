#entity = {
#	name = "combat_control_entity"
#	
#	locator = { name = "loc_1" position = { -5 0 0 } rotation = { -90 0 0 } }
#	locator = { name = "loc_2" position = { 5 0 0 } rotation = { 90 0 0 } }
#	
#	default_state = "loop"
#	
#	# This entity will have two attachments from code, called unit_1 and unit_2, that will be attached to loc_1 and loc_2 respectively
#	state = { name = "chill" state_time = 0.5 looping = no next_state = "loop" propagate_state = "idle" }
#	
#	# dude 1 attacks
#	state = { name = "loop" chance = 1.0 state_time = 2.0 looping = no next_state = "chill"
#		propagate_state = { "unit_1" = "attack" }
#		propagate_state = { "unit_2" = "defend" }
#	}
#	
#	# dude 2 attacks
#	state = { name = "loop" chance = 1.0 state_time = 2.0 looping = no next_state = "chill"
#		propagate_state = { "unit_1" = "defend" }
#		propagate_state = { "unit_2" = "attack" }
#	}
#	
#	#state = { name = "loop" chance = 0.5 state_time = 1.0 looping = no next_state = "loop"
#	#	propagate_state = { "unit_1" = "idle" }
#	#	propagate_state = { "unit_2" = "idle" }
#	#}	
#}


pdxmesh = {
	name = "combat_control_mesh"
	file = "combat_control.mesh"
	
	#scale = 0.08
}


entity = {
	name = "combat_control_entity"
	pdxmesh = "combat_control_mesh"
	default_state = "idle"

	# This entity will have two attachments from code, called unit_1 and unit_2, that will be attached to loc_1 and loc_2 respectively
	# When adding new animations, make sure to make them loop correctly in Maya in 30fps, then subract 0.07 seconds from the corresponding state_time for them. This will make them loop better and they won't go into a different state between states.
	state = { name = "idle" state_time = 0.01 looping = no next_state = "even" propagate_state = "idle" 
		event = {  sound = { soundeffect = "event:/SFX/Animations/Units/combat_ambience" stop_on_state_change = no}}	
	}

	# Even combat sequence even
	state = { name = "even" chance = 1.0 state_time = 5.06 looping = no
		propagate_state = { "unit_1" = "even_offensive_seq_1"  }
		propagate_state = { "unit_2" = "even_defensive_seq_1"  }

	event = { trigger_once = yes sound = { soundeffect = "event:/SFX/Animations/Units/combat_ambience" stop_on_state_change = no}}	
	}
	
	# Even combat sequence even
	state = { name = "even" chance = 1.0 state_time = 5.06 looping = no
		propagate_state = { "unit_1" = "even_defensive_seq_1" }
		propagate_state = { "unit_2" = "even_offensive_seq_1" }
		
	event = { trigger_once = yes sound = { soundeffect = "event:/SFX/Animations/Units/combat_ambience" stop_on_state_change = no}}	
	}
	
	# Win/lose combat sequence defender winning
	state = { name = "defender_winning" chance = 1.0 state_time = 3.33 looping = no
		propagate_state = { "unit_1" = "winlose_offensive_seq_1" }
		propagate_state = { "unit_2" = "winlose_defensive_seq_1" }		
		chance = {
			if_current_state = {
				"even" = 0
				"attacker_winning" = 0
				"defender_winning" = 100
				"defender_winning_tx_2" = 100
			}
			default = 0
		}
	event = { trigger_once = yes sound = { soundeffect = "event:/SFX/Animations/Units/combat_ambience" stop_on_state_change = no}}	
	}
	
	# Win/lose combat sequence attacker winning
	state = { name = "attacker_winning" chance = 1.0 state_time = 3.33 looping = no
		propagate_state = { "unit_1" = "winlose_defensive_seq_1" }
		propagate_state = { "unit_2" = "winlose_offensive_seq_1" }
		
		chance = {
			if_current_state = {
				"even" = 0
				"attacker_winning" = 100
				"defender_winning" = 0
				"attacker_winning_tx_2" = 100
			}
			default = 0
		}
	event = { trigger_once = yes sound = { soundeffect = "event:/SFX/Animations/Units/combat_ambience" stop_on_state_change = no}}	
	}
	
	# Pursuit combat sequence defender winning
	state = { name = "pursuit_defender_winning" chance = 1.0 state_time = 4.09 looping = no
		propagate_state = { "unit_1" = "pursuit_offensive_seq_1" }
		propagate_state = { "unit_2" = "pursuit_defensive_seq_1" }
		
	event = { trigger_once = yes sound = { soundeffect = "event:/SFX/Animations/Units/combat_ambience" stop_on_state_change = no}}	
	}
	
	# Pursuit combat sequence attacker winning
	state = { name = "pursuit_attacker_winning" chance = 1.0 state_time = 4.09 looping = no
		propagate_state = { "unit_1" = "pursuit_defensive_seq_1" }
		propagate_state = { "unit_2" = "pursuit_offensive_seq_1" }

	event = { trigger_once = yes sound = { soundeffect = "event:/SFX/Animations/Units/combat_ambience" stop_on_state_change = no}}	
	}
	
	
	# TRANSITIONS
	
	# Even to winlose transition defender winning
	state = { name = "defender_winning" state_time = 2.09 looping = no
		propagate_state = { "unit_1" = "even_winlose_tx_offensive_1" }
		propagate_state = { "unit_2" = "even_winlose_tx_defensive_1" }
		
		chance = {
			if_current_state = {
				"even" = 100
				"attacker_winning" = 0
				"defender_winning" = 0
				"defender_winning_tx_2" = 0
			}
			default = 0
		}
	}
	
	# Even to winlose transition attacker winning
	state = { name = "attacker_winning" state_time = 2.09 looping = no
		propagate_state = { "unit_1" = "even_winlose_tx_defensive_1" }
		propagate_state = { "unit_2" = "even_winlose_tx_offensive_1" }
		
		chance = {
			if_current_state = {
				"even" = 100
				"attacker_winning" = 0
				"defender_winning" = 0
				"attacker_winning_tx_2" = 0
			}
			default = 0
		}
	}
	
	
	# Winlose to even transition from defender winning
	state = { name = "even" chance = 1.0 state_time = 1.93 looping = no
		propagate_state = { "unit_1" = "winlose_even_tx_offensive_1" }
		propagate_state = { "unit_2" = "winlose_even_tx_defensive_1" }
		
		chance = {
			if_current_state = {
				"even" = 0
				"defender_winning" = 100
				"attacker_winning" = 0
			}
			default = 0
		}
	}
	
	# Winlose to even transition from attacker winning
	state = { name = "even" chance = 1.0 state_time = 1.93 looping = no
		propagate_state = { "unit_1" = "winlose_even_tx_defensive_1" }
		propagate_state = { "unit_2" = "winlose_even_tx_offensive_1" }
		
		chance = {
			if_current_state = {
				"even" = 0
				"defender_winning" = 0
				"attacker_winning" = 100
			}
			default = 0
		}
	}
	
	# Winlose to winlose combat sequence 1/2 attacker to defender winning
	state = { name = "defender_winning" state_time = 1.93 looping = no next_state = "defender_winning_tx_2"
		propagate_state = { "unit_1" = "winlose_even_tx_defensive_1" }
		propagate_state = { "unit_2" = "winlose_even_tx_offensive_1" }
		
		chance = {
			if_current_state = {
				"even" = 0
				"attacker_winning" = 100
				"defender_winning" = 0
				"defender_winning_tx_2" = 0
			}
			default = 0
		}
	}
	
	# Winlose to winlose combat sequence 2/2 attacker to defender winning
	state = { name = "defender_winning_tx_2" state_time = 2.09 looping = no
		propagate_state = { "unit_1" = "even_winlose_tx_offensive_1" }
		propagate_state = { "unit_2" = "even_winlose_tx_defensive_1" }
	}
	
	# Winlose to winlose combat sequence 1/2 defender to attacker winning
	state = { name = "attacker_winning" state_time = 1.93 looping = no next_state = "attacker_winning_tx_2"
		propagate_state = { "unit_1" = "winlose_even_tx_offensive_1" }
		propagate_state = { "unit_2" = "winlose_even_tx_defensive_1" }
		
		chance = {
			if_current_state = {
				"even" = 0
				"attacker_winning" = 0
				"defender_winning" = 100
				"attacker_winning_tx_2" = 0
			}
			default = 0
		}
	}
	
	# Winlose to winlose combat sequence 2/2 defender to attacker winning
	state = { name = "attacker_winning_tx_2" state_time = 2.09 looping = no
		propagate_state = { "unit_1" = "even_winlose_tx_defensive_1" }
		propagate_state = { "unit_2" = "even_winlose_tx_offensive_1" }
	}
	
	scale = 1
}