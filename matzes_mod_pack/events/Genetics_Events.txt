namespace = IG

############################################## IMPROVED GENETICS EVENT CHAIN ###############################################
# How it works: After the on_birth on action event, this event chain fires, it gives every character in the game a flag.   #
# The flags assign each character with one of three allele pairs: AA, Aa, or aa. These flags both determine the likelihood #
# of the trait manifesting in the character, and the likelihood that they will pass on this 'gene.' Gene inheritance is    #
# roughly modeled based on a simplistic model of Mendelian inheritance. The child will inherit an allele pair from their   # 
# parents based on a Punnett Square. Genes don't necessarily become traits, that is decided by a random genotype to pheno- #
# type chance. Some traits are 'Polygenic Inheritance.' These traits use 3 allele pairs,and the number of dominant alleles #
# capitals) determine the likelihood that the gene will be realized into a trait.Other genes are based on normal Mendelian #
# inheritance. These generally use two allele pairs, and if one of the pairs is recessive (two lower case) then there is a #
# chance for the character to get the negative trait.																	   #
############################################################################################################################


## Initializes Traits for non-historical characters. NO LONGER NEEDED.
IG.2 = {
	type = empty
	hidden = yes

	immediate = {
		## real_father
		every_living_character = {
			## Only give these traits to unimportant characters
			if = {
				limit = {
					NOR = {
						highest_held_title_tier = tier_empire
						highest_held_title_tier = tier_kingdom
						highest_held_title_tier = tier_duchy
					}
					is_ai = yes
				}

				random_list = {
					3 = {
						add_trait = dwarf
					}
					994 = {

					}
				}

				random_list = {
					3 = {
						add_trait = giant
					}
					994 = {
						
					}
				}

				random_list = {
					4 = {
						add_trait = clubfooted
					}
					993 = {
						
					}
				}

				random_list = {
					4 = {
						add_trait = wheezing
					}
					993 = {
						
					}
				}

				random_list = {
					4 = {
						add_trait = lisping
					}
					993 = {
						
					}
				}

				random_list = {
					4 = {
						add_trait = stuttering
					}
					993 = {
						
					}
				}

				random_list = {
					3 = {
						add_trait = spindly
					}
					994 = {
						
					}
				}

				random_list = {
					1 = {
						modifier = {
							is_female = no
							add = 5
						}
						add_trait = bleeder
					}
					994 = {
						
					}
				}

				random_list = {
					4 = {
						add_trait = hunchbacked
					}
					994 = {
						
					}
				}

				random_list = {
					3 = {
						add_trait = scaly
					}
					994 = {
						
					}
				}

				random_list = {
					4 = {
						add_trait = albino
					}
					992 = {
						
					}
				}
				if = {
					limit = {
						NOR = {
							has_trait = intellect_good_3
							has_trait = intellect_good_2
							has_trait = intellect_good_1
							has_trait = intellect_bad_1
							has_trait = intellect_bad_2
							has_trait = intellect_bad_3
						}
						
						## Important characters dont get...
					}

					random_list = {
						1 = {
							add_trait = intellect_good_3
						}
						3 = {
							add_trait = intellect_good_2
						}
						8 = {
							add_trait = intellect_good_1
						}
						1 = {
							add_trait = intellect_bad_3
						}
						3 = {
							add_trait = intellect_bad_2
						}
						8 = {
							add_trait = intellect_bad_1
						}
						975 = {
							
						}
					}
				}


				if = {
					limit = {
						NOR = {
							has_trait = physique_good_3
							has_trait = physique_good_2
							has_trait = physique_good_1
							has_trait = physique_bad_1
							has_trait = physique_bad_2
							has_trait = physique_bad_3
						}
						
						## Important characters dont get...
					}

					random_list = {
						1 = {
							add_trait = physique_good_3
						}
						3 = {
							add_trait = physique_good_2
						}
						8 = {
							add_trait = physique_good_1
						}
						1 = {
							add_trait = physique_bad_3
						}
						3 = {
							add_trait = physique_bad_2
						}
						8 = {
							add_trait = physique_bad_1
						}
						975 = {
							
						}
					}
				}


				if = {
					limit = {
						NOR = {
							has_trait = beauty_good_3
							has_trait = beauty_good_2
							has_trait = beauty_good_1
							has_trait = beauty_bad_1
							has_trait = beauty_bad_2
							has_trait = beauty_bad_3
							has_trait = scaly
						}
						
						## Important characters dont get...
					}

					random_list = {
						1 = {
							add_trait = beauty_good_3
						}
						3 = {
							add_trait = beauty_good_2
						}
						8 = {
							add_trait = beauty_good_1
						}
						1 = {
							add_trait = beauty_bad_3
						}
						3 = {
							add_trait = beauty_bad_2
						}
						8 = {
							add_trait = beauty_bad_1
						}
						975 = {
							
						}
					}
				}

				if = {
					limit = {
						NOR = {
							has_trait = towering
							has_trait = tall
							has_trait = short
							has_trait = tiny
						}
						
						## Important characters dont get...
					}

					random_list = {
						1 = {
							add_trait = towering
						}
						5 = {
							add_trait = tall
						}
						12 = {
							add_character_flag = tallish
						}
						25 = {
							add_character_flag = tallish2
						}
						50 = {
							add_character_flag = tallish3
						}
						1 = {
							add_trait = tiny
						}
						5 = {
							add_trait = short
						}
						12 = {
							add_character_flag = shortish
						}
						25 = {
							add_character_flag = shortish2
						}
						50 = {
							add_character_flag = shortish3
						}
						820 = {
							
						}
					}
				}
			}
			
		}
	}
}

## Sets player genes dependent almost entirely on their phenotype. No phenotype = normal genes
IG.3 = {

	type = empty
	hidden = yes

	immediate = {
		every_living_character = {			
			if = {
				limit = {
					is_ai = no
				}
				if = {
					limit = {
						NOR = {
							has_trait = intellect_good_1
							has_trait = intellect_good_2
							has_trait = intellect_good_3
							has_trait = intellect_bad_1
							has_trait = intellect_bad_2
							has_trait = intellect_bad_3
						}
					}
					add_character_flag = int_Aa
					add_character_flag = int_Bb
					add_character_flag = int_Cc
				}
				if = {
					limit = {
						NOR = {
							has_trait = physique_good_1
							has_trait = physique_good_2
							has_trait = physique_good_3
							has_trait = physique_bad_1
							has_trait = physique_bad_2
							has_trait = physique_bad_3
						}
					}
					add_character_flag = str_Aa
					add_character_flag = str_Bb
					add_character_flag = str_Cc
				}
				if = {
					limit = {
						NOR = {
							has_trait = beauty_good_1
							has_trait = beauty_good_2
							has_trait = beauty_good_3
							has_trait = beauty_bad_1
							has_trait = beauty_bad_2
							has_trait = beauty_bad_3
						}
					}
					add_character_flag = att_Aa
					add_character_flag = att_Bb
					add_character_flag = att_Cc
				}
				if = {
					limit = {
						NOR = {
							has_trait = towering
							has_trait = tall
							has_trait = short
							has_trait = tiny
						}
					}

					add_character_flag = hgt_Aa
					add_character_flag = hgt_Bb
					add_character_flag = hgt_Cc
					add_character_flag = hgt_Dd
					add_character_flag = hgt_Ee
					add_character_flag = hgt_Ff
				}

				if = {
					limit = {
						NOT = {
							has_trait = clubfooted
						}
					}
					add_character_flag = clubfoot_AA
					add_character_flag = clubfoot_BB
					add_character_flag = clubfoot_CC
				}
				if = {
					limit = {
						NOT = {
							has_trait = lisping
						}
					}
					add_character_flag = lisping_AA
					add_character_flag = lisping_BB
					add_character_flag = lisping_CC			
				}
				if = {
					limit = {
						NOT = {
							has_trait = stuttering
						}
					}
					add_character_flag = stuttering_AA
					add_character_flag = stuttering_BB
					add_character_flag = stuttering_CC
				}
				if = {
					limit = {
						NOT = {
							has_trait = wheezing
						}
					}
					add_character_flag = wheezing_AA
					add_character_flag = wheezing_BB
					add_character_flag = wheezing_CC
				}
				if = {
					limit = {
						NOT = {
							has_trait = hunchbacked
						}
					}
					add_character_flag = hunchbacked_AA
					add_character_flag = hunchbacked_BB
					add_character_flag = hunchbacked_CC
				}

				if = {
					limit = {
						NOT = {
							has_trait = dwarf
						}
					}
				}

				if = {
					limit = {
						NOT = {
							has_trait = giant
						}
					}
					add_character_flag = giant_aa
				}

				if = {
					limit = {
						NOT = {
							has_trait = spindly
						}
					}
					add_character_flag = spindly_aa
				}

				if = {
					limit = {
						NOT = {
							has_trait = albino
						}
					}
					add_character_flag = albino_AA
				}


				if = {
					limit = {
						NOT = {
							has_trait = bleeder
						}
					}
					add_character_flag = bleeder_AA
				}

				if = {
					limit = {
						NOT = {
							has_trait = scaly
						}
					}
					add_character_flag = scl_aa
				}
			}
		}
			
	}
	
}


## BIRTH EVENT CHAIN.
## THIS CHAIN ALSO ASSIGNS GENES TO THE PARENTS!

## Complications:
## MOTHER DIES DURING CHILDBIRTH (does the mother die first?)
## BABIES ARE TWINS

IG.10 = {

	type = character_event
	hidden = yes

	trigger = {
		always = yes
	}

	immediate = {

	}	
}

## Begin Event chain

## INTELLIGENCE - Polygenic, 3 alleles.
IG.100 = {
	type = character_event
	hidden = yes

	immediate = {			
		## 1. Initialization. Only executes if parents have no flags
			if = {
				limit = {
					real_father = {
						NOR = {
							has_character_flag = int_AA
							has_character_flag = int_Aa
							has_character_flag = int_aa
							has_character_flag = int_BB
							has_character_flag = int_Bb
							has_character_flag = int_bb
							has_character_flag = int_CC
							has_character_flag = int_Cc
							has_character_flag = int_cc
						}
					}
				}
				real_father = {
					if = {
						limit = {
							has_trait = intellect_good_3
						}
						# Portrait Modification
						int_6_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = intellect_good_2
						}
						# Portrait Modification
						int_5_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = intellect_good_1
						}
						int_4_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = intellect_bad_1
						}
						int_3_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = intellect_bad_2
						}
						int_2_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = intellect_bad_3
						}
						int_1_flag_tgr = yes
					}
					else = {
						average_int_flag_tgr = yes
					}
				}
			}
			if = {
				limit = {
					mother = {
						NOR = {
							has_character_flag = int_AA
							has_character_flag = int_Aa
							has_character_flag = int_aa
							has_character_flag = int_BB
							has_character_flag = int_Bb
							has_character_flag = int_bb
							has_character_flag = int_CC
							has_character_flag = int_Cc
							has_character_flag = int_cc
						}
					}
				}
				mother = {
					if = {
						limit = {
							has_trait = intellect_good_3
						}
						int_6_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = intellect_good_2
						}
						int_5_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = intellect_good_1
						}
						int_4_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = intellect_bad_1
						}
						int_3_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = intellect_bad_2
						}
						int_2_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = intellect_bad_3
						}
						int_1_flag_tgr = yes
					}
					else = {
						average_int_flag_tgr = yes
					}
				}
			}
			
		## 2. Punnett Square
			set_variable = { name = alleles value = 0 }
			
			if = {
			
				limit = {
					real_father = {
						has_character_flag = int_AA
					}
					mother = {
						has_character_flag = int_AA
					}
				}
				add_character_flag = int_AA
				change_variable = { name = alleles add = 2 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_AA
					}
					mother = {
						has_character_flag = int_Aa
					}
				}
				random_list = {
				50 = {
				add_character_flag = int_AA
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = int_Aa
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = int_Aa
				}
				mother = {
					has_character_flag = int_AA
				}
				}
				random_list = {
				50 = {
				add_character_flag = int_AA
				change_variable = { name = alleles add = 2 }

				}
				50 = {
				add_character_flag = int_Aa
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = int_Aa
				}
				mother = {
					has_character_flag = int_Aa
				}
				}
				random_list = {
				25 = {
				add_character_flag = int_AA
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = int_Aa
				change_variable = { name = alleles add = 1 }
				}
				25 = {
				add_character_flag = int_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = int_AA
				}
				mother = {
					has_character_flag = int_aa
				}
				}
				add_character_flag = int_Aa
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = int_aa
				}
				mother = {
					has_character_flag = int_AA
				}
				}
				add_character_flag = int_Aa
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = int_Aa
				}
				mother = {
					has_character_flag = int_aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = int_Aa
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = int_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = int_aa
				}
				mother = {
					has_character_flag = int_Aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = int_Aa
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = int_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = int_aa
				}
				mother = {
					has_character_flag = int_aa
				}
				}
				add_character_flag = int_aa
			}
			else = {
				add_character_flag = int_Aa
				change_variable = { name = alleles add = 1 }
			}
		
			if = {
			
				limit = {
					real_father = {
						has_character_flag = int_BB
					}
					mother = {
						has_character_flag = int_BB
					}
				}
				add_character_flag = int_BB
				change_variable = { name = alleles add = 2 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_BB
					}
					mother = {
						has_character_flag = int_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = int_BB
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = int_Bb
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_Bb
					}
					mother = {
						has_character_flag = int_BB
					}
				}
				random_list = {
				50 = {
				add_character_flag = int_BB
				change_variable = { name = alleles add = 2 }

				}
				50 = {
				add_character_flag = int_Bb
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_Bb
					}
					mother = {
						has_character_flag = int_Bb
					}
				}
				random_list = {
				25 = {
				add_character_flag = int_BB
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = int_Bb
				change_variable = { name = alleles add = 1 }
				}
				25 = {
				add_character_flag = int_bb
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_BB
					}
					mother = {
						has_character_flag = int_bb
					}
				}
				add_character_flag = int_Bb
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_bb
					}
					mother = {
						has_character_flag = int_BB
					}
				}
				add_character_flag = int_Bb
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_Bb
					}
					mother = {
						has_character_flag = int_bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = int_Bb
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = int_bb
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_bb
					}
					mother = {
						has_character_flag = int_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = int_Bb
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = int_bb
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_bb
					}
					mother = {
						has_character_flag = int_bb
					}
				}
				add_character_flag = int_bb
			}
			else = {
				add_character_flag = int_Bb
				change_variable = { name = alleles add = 1 }
			}

			if = {
			
				limit = {
					real_father = {
						has_character_flag = int_CC
					}
					mother = {
						has_character_flag = int_CC
					}
				}
				add_character_flag = int_CC
				change_variable = { name = alleles add = 2 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_CC
					}
					mother = {
						has_character_flag = int_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = int_CC
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = int_Cc
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_Cc
					}
					mother = {
						has_character_flag = int_CC
					}
				}
				random_list = {
				50 = {
				add_character_flag = int_CC
				change_variable = { name = alleles add = 2 }

				}
				50 = {
				add_character_flag = int_Cc
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_Cc
					}
					mother = {
						has_character_flag = int_Cc
					}
				}
				random_list = {
				25 = {
				add_character_flag = int_CC
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = int_Cc
				change_variable = { name = alleles add = 1 }
				}
				25 = {
				add_character_flag = int_cc
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_CC
					}
					mother = {
						has_character_flag = int_cc
					}
				}
				add_character_flag = int_Cc
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_cc
					}
					mother = {
						has_character_flag = int_CC
					}
				}
				add_character_flag = int_Cc
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_Cc
					}
					mother = {
						has_character_flag = int_cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = int_Cc
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = int_cc
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_cc
					}
					mother = {
						has_character_flag = int_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = int_Cc
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = int_cc
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = int_cc
					}
					mother = {
						has_character_flag = int_cc
					}
				}
				add_character_flag = int_cc
			}
			else = {
				add_character_flag = int_Cc
				change_variable = { name = alleles add = 1 }
			}
		
		## 3. Mutation
			if = {
				limit = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = blood_legacy_1
					}
				}
				if = {
					limit = {
						has_character_flag = int_Aa
					}
					random_list = {
						0 = {
							modifier = {
								dynasty = {
									has_dynasty_perk = blood_legacy_1
								}
								add = 25
							}
							add_character_flag = is_blood_legacy_working_as_intended
							remove_character_flag = int_Aa
							add_character_flag = int_AA
							change_variable = { name = alleles add = 1 }
						}
						975 = {

						}
					}
				}
				if = {
					limit = {
						has_character_flag = int_Bb
					}
					random_list = {
						0 = {
							modifier = {
								exists = dynasty
								dynasty = {
									has_dynasty_perk = blood_legacy_1
								}
								add = 25
							}
							remove_character_flag = int_Bb
							add_character_flag = int_BB
							change_variable = { name = alleles add = 1 }
						}
						975 = {

						}
					}
				}
				if = {
					limit = {
						has_character_flag = int_Cc
					}
					random_list = {
						0 = {
							modifier = {
								exists = dynasty
								dynasty = {
									has_dynasty_perk = blood_legacy_1
								}
								add = 25
							}
							remove_character_flag = int_Aa
							add_character_flag = int_AA
							change_variable = { name = alleles add = 1 }
						}
						975 = {

						}
					}
				}

			}

		## 4. Phenotype to genotype conversion
			if = {
				limit = {
					var:alleles >= 6
					NOT = {
						OR = {
							has_trait = intellect_good_3
							has_trait = intellect_good_2
							has_trait = intellect_bad_3
							has_trait = intellect_bad_2
							has_trait = intellect_good_1
							has_trait = intellect_bad_1
						}
					}
				}
				random_list = {
					35 = {
						modifier = {
								exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 20
						}
						add_trait = intellect_good_3
					}
					55 = {
						add_trait = intellect_good_2
					}
					10 = {
						add_trait = intellect_good_1
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 5
					NOT = {
						OR = {
							has_trait = intellect_good_3
							has_trait = intellect_good_2
							has_trait = intellect_bad_3
							has_trait = intellect_bad_2
							has_trait = intellect_good_1
							has_trait = intellect_bad_1
						}
					}
				}
				random_list = {
					1 = {
						modifier = {
								exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 5
						}
						add_trait = intellect_good_3
					}
					17 = {
						modifier = {
								exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 10
						}
						add_trait = intellect_good_2
					}
					45 = {
						add_trait = intellect_good_1
					}
					39 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 4
					NOT = {
						OR = {
							has_trait = intellect_good_3
							has_trait = intellect_good_2
							has_trait = intellect_bad_3
							has_trait = intellect_bad_2
							has_trait = intellect_good_1
							has_trait = intellect_bad_1
						}
					}
				}
				random_list = {
					4 = {
						modifier = {
								exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 20
						}
						modifier = {
								exists = dynasty
							dynasty = {
								exists = var:blood_legacy_4_intellect_good_1
							}
							add = 90
						}
						add_trait = intellect_good_1
					}
					196 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 3
					NOT = {
						OR = {
							has_trait = intellect_good_3
							has_trait = intellect_good_2
							has_trait = intellect_bad_3
							has_trait = intellect_bad_2
							has_trait = intellect_good_1
							has_trait = intellect_bad_1
						}
					}
				}
				random_list = {
					0 = {
						modifier = {
								exists = dynasty
							dynasty = {
								exists = var:blood_legacy_4_intellect_good_1
							}
							add = 20
						}
						add_trait = intellect_good_1
					}
					90 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 2
					NOT = {
						OR = {
							has_trait = intellect_good_3
							has_trait = intellect_good_2
							has_trait = intellect_bad_3
							has_trait = intellect_bad_2
							has_trait = intellect_good_1
							has_trait = intellect_bad_1
						}
					}
				}
				random_list = {
					4 = {
					add_trait = intellect_bad_1
					}
					196 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 1
					NOT = {
						OR = {
							has_trait = intellect_good_3
							has_trait = intellect_good_2
							has_trait = intellect_bad_3
							has_trait = intellect_bad_2
							has_trait = intellect_good_1
							has_trait = intellect_bad_1
						}
					}
				}
				random_list = {
					1 = {
					add_trait = intellect_bad_3
					}
					15 = {
					add_trait = intellect_bad_2
					}
					42 = {
					add_trait = intellect_bad_1
					}
					42 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 0
					NOT = {
						OR = {
							has_trait = intellect_good_3
							has_trait = intellect_good_2
							has_trait = intellect_bad_3
							has_trait = intellect_bad_2
							has_trait = intellect_good_1
							has_trait = intellect_bad_1
						}
					}
				}
				random_list = {
					35 = {
					add_trait = intellect_bad_3
					}
					55 = {
					add_trait = intellect_bad_2
					}
					10 = {
					add_trait = intellect_bad_1
					}
				}
			}
			else = {
			}
	}
}

## STRENGTH - Polygenic, 3 alleles.
IG.101 = {
	type = character_event
	hidden = yes

	immediate = {			
		## 1. Initialization. Only executes if parents have no flags
			if = {
				limit = {
					real_father = {
						NOR = {
							has_character_flag = str_AA
							has_character_flag = str_Aa
							has_character_flag = str_aa
							has_character_flag = str_BB
							has_character_flag = str_Bb
							has_character_flag = str_bb
							has_character_flag = str_CC
							has_character_flag = str_Cc
							has_character_flag = str_cc
						}
					}
				}
				real_father = {
					if = {
						limit = {
							has_trait = physique_good_3
						}
						# Portrait Modification
						str_6_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = physique_good_2
						}
						# Portrait Modification
						str_5_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = physique_good_1
						}
						str_4_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = physique_bad_1
						}
						str_3_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = physique_bad_2
						}
						str_2_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = physique_bad_3
						}
						str_1_flag_tgr = yes
					}
					else = {
						average_str_flag_tgr = yes
					}
				}
			}
			if = {
				limit = {
					mother = {
						NOR = {
							has_character_flag = str_AA
							has_character_flag = str_Aa
							has_character_flag = str_aa
							has_character_flag = str_BB
							has_character_flag = str_Bb
							has_character_flag = str_bb
							has_character_flag = str_CC
							has_character_flag = str_Cc
							has_character_flag = str_cc
						}
					}
				}
				mother = {
					if = {
						limit = {
							has_trait = physique_good_3
						}
						str_6_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = physique_good_2
						}
						str_5_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = physique_good_1
						}
						str_4_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = physique_bad_1
						}
						str_3_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = physique_bad_2
						}
						str_2_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = physique_bad_3
						}
						str_1_flag_tgr = yes
					}
					else = {
						average_str_flag_tgr = yes
					}
				}
			}
			
		## 2. Punnett Square
			set_variable = { name = alleles value = 0 }
			
			if = {
			
				limit = {
					real_father = {
						has_character_flag = str_AA
					}
					mother = {
						has_character_flag = str_AA
					}
				}
				add_character_flag = str_AA
				change_variable = { name = alleles add = 2 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_AA
					}
					mother = {
						has_character_flag = str_Aa
					}
				}
				random_list = {
				50 = {
				add_character_flag = str_AA
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = str_Aa
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = str_Aa
				}
				mother = {
					has_character_flag = str_AA
				}
				}
				random_list = {
				50 = {
				add_character_flag = str_AA
				change_variable = { name = alleles add = 2 }

				}
				50 = {
				add_character_flag = str_Aa
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = str_Aa
				}
				mother = {
					has_character_flag = str_Aa
				}
				}
				random_list = {
				25 = {
				add_character_flag = str_AA
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = str_Aa
				change_variable = { name = alleles add = 1 }
				}
				25 = {
				add_character_flag = str_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = str_AA
				}
				mother = {
					has_character_flag = str_aa
				}
				}
				add_character_flag = str_Aa
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = str_aa
				}
				mother = {
					has_character_flag = str_AA
				}
				}
				add_character_flag = str_Aa
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = str_Aa
				}
				mother = {
					has_character_flag = str_aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = str_Aa
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = str_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = str_aa
				}
				mother = {
					has_character_flag = str_Aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = str_Aa
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = str_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = str_aa
				}
				mother = {
					has_character_flag = str_aa
				}
				}
				add_character_flag = str_aa
			}
			else = {
				add_character_flag = str_Aa
				change_variable = { name = alleles add = 1 }
			}
		
			if = {
			
				limit = {
					real_father = {
						has_character_flag = str_BB
					}
					mother = {
						has_character_flag = str_BB
					}
				}
				add_character_flag = str_BB
				change_variable = { name = alleles add = 2 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_BB
					}
					mother = {
						has_character_flag = str_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = str_BB
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = str_Bb
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_Bb
					}
					mother = {
						has_character_flag = str_BB
					}
				}
				random_list = {
				50 = {
				add_character_flag = str_BB
				change_variable = { name = alleles add = 2 }

				}
				50 = {
				add_character_flag = str_Bb
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_Bb
					}
					mother = {
						has_character_flag = str_Bb
					}
				}
				random_list = {
				25 = {
				add_character_flag = str_BB
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = str_Bb
				change_variable = { name = alleles add = 1 }
				}
				25 = {
				add_character_flag = str_bb
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_BB
					}
					mother = {
						has_character_flag = str_bb
					}
				}
				add_character_flag = str_Bb
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_bb
					}
					mother = {
						has_character_flag = str_BB
					}
				}
				add_character_flag = str_Bb
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_Bb
					}
					mother = {
						has_character_flag = str_bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = str_Bb
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = str_bb
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_bb
					}
					mother = {
						has_character_flag = str_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = str_Bb
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = str_bb
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_bb
					}
					mother = {
						has_character_flag = str_bb
					}
				}
				add_character_flag = str_bb
			}
			else = {
				add_character_flag = str_Bb
				change_variable = { name = alleles add = 1 }
			}

			if = {
			
				limit = {
					real_father = {
						has_character_flag = str_CC
					}
					mother = {
						has_character_flag = str_CC
					}
				}
				add_character_flag = str_CC
				change_variable = { name = alleles add = 2 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_CC
					}
					mother = {
						has_character_flag = str_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = str_CC
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = str_Cc
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_Cc
					}
					mother = {
						has_character_flag = str_CC
					}
				}
				random_list = {
				50 = {
				add_character_flag = str_CC
				change_variable = { name = alleles add = 2 }

				}
				50 = {
				add_character_flag = str_Cc
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_Cc
					}
					mother = {
						has_character_flag = str_Cc
					}
				}
				random_list = {
				25 = {
				add_character_flag = str_CC
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = str_Cc
				change_variable = { name = alleles add = 1 }
				}
				25 = {
				add_character_flag = str_cc
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_CC
					}
					mother = {
						has_character_flag = str_cc
					}
				}
				add_character_flag = str_Cc
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_cc
					}
					mother = {
						has_character_flag = str_CC
					}
				}
				add_character_flag = str_Cc
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_Cc
					}
					mother = {
						has_character_flag = str_cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = str_Cc
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = str_cc
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_cc
					}
					mother = {
						has_character_flag = str_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = str_Cc
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = str_cc
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = str_cc
					}
					mother = {
						has_character_flag = str_cc
					}
				}
				add_character_flag = str_cc
			}
			else = {
				add_character_flag = str_Cc
				change_variable = { name = alleles add = 1 }
			}
		
		## 3. Mutation
			if = {
				limit = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = blood_legacy_1
					}
				}
				if = {
					limit = {
						has_character_flag = str_Aa
					}
					random_list = {
						0 = {
							modifier = {
								exists = dynasty
								dynasty = {
									has_dynasty_perk = blood_legacy_1
								}
								add = 25
							}
							add_character_flag = is_blood_legacy_working_as_intended
							remove_character_flag = str_Aa
							add_character_flag = str_AA
							change_variable = { name = alleles add = 1 }
						}
						975 = {

						}
					}
				}
				if = {
					limit = {
						has_character_flag = str_Bb
					}
					random_list = {
						0 = {
							modifier = {
								exists = dynasty
								dynasty = {
									has_dynasty_perk = blood_legacy_1
								}
								add = 25
							}
							remove_character_flag = str_Bb
							add_character_flag = str_BB
							change_variable = { name = alleles add = 1 }
						}
						975 = {

						}
					}
				}
				if = {
					limit = {
						has_character_flag = str_Cc
					}
					random_list = {
						0 = {
							modifier = {
								exists = dynasty
								dynasty = {
									has_dynasty_perk = blood_legacy_1
								}
								add = 25
							}
							remove_character_flag = str_Aa
							add_character_flag = str_AA
							change_variable = { name = alleles add = 1 }
						}
						975 = {

						}
					}
				}

			}

		## 4. Phenotype to genotype conversion
			if = {
				limit = {
					var:alleles >= 6
					NOT = {
						OR = {
							has_trait = physique_good_3
							has_trait = physique_good_2
							has_trait = physique_bad_3
							has_trait = physique_bad_2
							has_trait = physique_good_1
							has_trait = physique_bad_1
						}
					}
				}
				random_list = {
					35 = {
						modifier = {
								exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 20
						}
						add_trait = physique_good_3
					}
					55 = {
						add_trait = physique_good_2
					}
					10 = {
						add_trait = physique_good_1
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 5
					NOT = {
						OR = {
							has_trait = physique_good_3
							has_trait = physique_good_2
							has_trait = physique_bad_3
							has_trait = physique_bad_2
							has_trait = physique_good_1
							has_trait = physique_bad_1
						}
					}
				}
				random_list = {
					1 = {
						modifier = {
								exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 5
						}
						add_trait = physique_good_3
					}
					17 = {
						modifier = {
								exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 10
						}
						add_trait = physique_good_2
					}
					45 = {
						add_trait = physique_good_1
					}
					39 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 4
					NOT = {
						OR = {
							has_trait = physique_good_3
							has_trait = physique_good_2
							has_trait = physique_bad_3
							has_trait = physique_bad_2
							has_trait = physique_good_1
							has_trait = physique_bad_1
						}
					}
				}
				random_list = {
					4 = {
						modifier = {
								exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 20
						}
						modifier = {
								exists = dynasty
							dynasty = {
								exists = var:blood_legacy_4_physique_good_1
							}
							add = 90
						}
						add_trait = physique_good_1
					}
					196 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 3
					NOT = {
						OR = {
							has_trait = physique_good_3
							has_trait = physique_good_2
							has_trait = physique_bad_3
							has_trait = physique_bad_2
							has_trait = physique_good_1
							has_trait = physique_bad_1
						}
					}
				}
				random_list = {
					0 = {
						modifier = {
							exists = dynasty
							dynasty = {
								exists = var:blood_legacy_4_physique_good_1
							}
							add = 20
						}
						add_trait = physique_good_1
					}
					90 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 2
					NOT = {
						OR = {
							has_trait = physique_good_3
							has_trait = physique_good_2
							has_trait = physique_bad_3
							has_trait = physique_bad_2
							has_trait = physique_good_1
							has_trait = physique_bad_1
						}
					}
				}
				random_list = {
					4 = {
					add_trait = physique_bad_1
					}
					196 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 1
					NOT = {
						OR = {
							has_trait = physique_good_3
							has_trait = physique_good_2
							has_trait = physique_bad_3
							has_trait = physique_bad_2
							has_trait = physique_good_1
							has_trait = physique_bad_1
						}
					}
				}
				random_list = {
					1 = {
					add_trait = physique_bad_3
					}
					15 = {
					add_trait = physique_bad_2
					}
					42 = {
					add_trait = physique_bad_1
					}
					42 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 0
					NOT = {
						OR = {
							has_trait = physique_good_3
							has_trait = physique_good_2
							has_trait = physique_bad_3
							has_trait = physique_bad_2
							has_trait = physique_good_1
							has_trait = physique_bad_1
						}
					}
				}
				random_list = {
					35 = {
					add_trait = physique_bad_3
					}
					55 = {
					add_trait = physique_bad_2
					}
					10 = {
					add_trait = physique_bad_1
					}
				}
			}
			else = {
			}
	}
}

## SCALY - Single Dominant
IG.102 = {
	type = character_event
	hidden = yes

	immediate = {
		
			
		## 2. Initialization. Only executes if parents have no flags
		if = {
			limit = {
				real_father = {
					NOR = {
						has_character_flag = scl_AA
						has_character_flag = scl_Aa
						has_character_flag = scl_aa
					}
				}
			}
			real_father = {
				if = {
					limit = {
						has_trait = scaly
					}
					random_list = {
						1 = {
							add_character_flag = scl_AA
						}
						4 = {
							add_character_flag = scl_Aa
						}
					}
				}
				else = {
					add_character_flag = scl_aa
				}
			}
		}
		if = {
			limit = {
				mother = {
					NOR = {
						has_character_flag = scl_AA
						has_character_flag = scl_Aa
						has_character_flag = scl_aa
					}
				}
			}
			mother = {
				if = {
					limit = {
						has_trait = scaly
					}
					random_list = {
						1 = {
							add_character_flag = scl_AA
						}
						4 = {
							add_character_flag = scl_Aa
						}
					}
				}
				else = {
					add_character_flag = scl_aa
				}
			}
		}



		
		
		## 3. Punnett Square
		set_variable = { name = alleles value = 0 }
		
		if = {
		
			limit = {
				real_father = {
					has_character_flag = scl_AA
				}
				mother = {
					has_character_flag = scl_AA
				}
			}
			add_character_flag = scl_AA
			change_variable = { name = alleles add = 2 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = scl_AA
				}
				mother = {
					has_character_flag = scl_Aa
				}
			}
			random_list = {
			50 = {
			add_character_flag = scl_AA
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = scl_Aa
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = scl_Aa
			}
			mother = {
				has_character_flag = scl_AA
			}
			}
			random_list = {
			50 = {
			add_character_flag = scl_AA
			change_variable = { name = alleles add = 2 }

			}
			50 = {
			add_character_flag = scl_Aa
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = scl_Aa
			}
			mother = {
				has_character_flag = scl_Aa
			}
			}
			random_list = {
			25 = {
			add_character_flag = scl_AA
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = scl_Aa
			change_variable = { name = alleles add = 1 }
			}
			25 = {
			add_character_flag = scl_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = scl_AA
			}
			mother = {
				has_character_flag = scl_aa
			}
			}
			add_character_flag = scl_Aa
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = scl_aa
			}
			mother = {
				has_character_flag = scl_AA
			}
			}
			add_character_flag = scl_Aa
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = scl_Aa
			}
			mother = {
				has_character_flag = scl_aa
			}
			}
			random_list = {
			50 = {
			add_character_flag = scl_Aa
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = scl_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = scl_aa
			}
			mother = {
				has_character_flag = scl_Aa
			}
			}
			random_list = {
			50 = {
			add_character_flag = scl_Aa
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = scl_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = scl_aa
			}
			mother = {
				has_character_flag = scl_aa
			}
			}
			add_character_flag = scl_aa
		}
		else = {
			add_character_flag = scl_aa
		}

	## Mutation 

		set_variable = { name = mutation value = 4 }

		scope:mother = {
			save_temporary_scope_as = compare_character
		}

		if = {
			limit = {
				real_father = {
					is_close_family_of_compare_character_trigger = yes
				}
				
			}
			change_variable = { name = mutation multiply = 4 } ## should increase to 15*3 = 45 with the second one! ~5% chance for a mutation.
		}
		if = {
			limit = {
				real_father = {
					is_close_or_extended_family_of = scope:compare_character
				}
			}
			change_variable = { name = mutation multiply = 2 }
		}

		if = {
			limit = {
				exists = dynasty
				dynasty = {
					exists = var:blood_legacy_4_scaly
				}
			}
			change_variable = { name = mutation add = 150 }
		}

		if = {
			limit = {
				has_character_flag = scl_aa
			}
			random_list = {
				0 = {
					modifier = {
						add = { 
							value = var:mutation
						}
					}
					remove_character_flag = scl_aa
					add_character_flag = scl_Aa
					change_variable = { name = alleles add = 1 }
				}
				997 = {

				}
			}
		}

	#4. Phenotype to genotype conversion
		if = {
			limit = {
				var:alleles >= 1
				NOT = {
					has_trait = scaly
				}
			}
			add_trait = scaly
		}
		else = {
		}
	}
}

## ATTRACTIVE - Polygenic, 3 alleles.
IG.103 = {
	type = character_event
	hidden = yes

	immediate = {			
		## 1. Initialization. Only executes if parents have no flags
			if = {
				limit = {
					real_father = {
						NOR = {
							has_character_flag = att_AA
							has_character_flag = att_Aa

							has_character_flag = att_aa
							has_character_flag = att_BB
							has_character_flag = att_Bb
							has_character_flag = att_bb
							has_character_flag = att_CC
							has_character_flag = att_Cc
							has_character_flag = att_cc
						}
					}
				}
				real_father = {
					if = {
						limit = {
							has_trait = beauty_good_3
						}
						# Portrait Modification
						att_6_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = beauty_good_2
						}
						# Portrait Modification
						att_5_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = beauty_good_1
						}
						att_4_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = beauty_bad_1
						}
						att_3_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = beauty_bad_2
						}
						att_2_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = beauty_bad_3
						}
						att_1_flag_tgr = yes
					}
					else = {
						average_att_flag_tgr = yes
					}
				}
			}
			if = {
				limit = {
					mother = {
						NOR = {
							has_character_flag = att_AA
							has_character_flag = att_Aa
							has_character_flag = att_aa
							has_character_flag = att_BB
							has_character_flag = att_Bb
							has_character_flag = att_bb
							has_character_flag = att_CC
							has_character_flag = att_Cc
							has_character_flag = att_cc
						}
					}
				}
				mother = {
					if = {
						limit = {
							has_trait = beauty_good_3
						}
						att_6_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = beauty_good_2
						}
						att_5_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = beauty_good_1
						}
						att_4_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = beauty_bad_1
						}
						att_3_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = beauty_bad_2
						}
						att_2_flag_tgr = yes
					}
					else_if = {
						limit = {
							has_trait = beauty_bad_3
						}
						att_1_flag_tgr = yes
					}
					else = {
						average_att_flag_tgr = yes
					}
				}
			}
			
		## 2. Punnett Square
			set_variable = { name = alleles value = 0 }
			
			if = {
			
				limit = {
					real_father = {
						has_character_flag = att_AA
					}
					mother = {
						has_character_flag = att_AA
					}
				}
				add_character_flag = att_AA
				change_variable = { name = alleles add = 2 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_AA
					}
					mother = {
						has_character_flag = att_Aa
					}
				}
				random_list = {
				50 = {
				add_character_flag = att_AA
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = att_Aa
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = att_Aa
				}
				mother = {
					has_character_flag = att_AA
				}
				}
				random_list = {
				50 = {
				add_character_flag = att_AA
				change_variable = { name = alleles add = 2 }

				}
				50 = {
				add_character_flag = att_Aa
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = att_Aa
				}
				mother = {
					has_character_flag = att_Aa
				}
				}
				random_list = {
				25 = {
				add_character_flag = att_AA
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = att_Aa
				change_variable = { name = alleles add = 1 }
				}
				25 = {
				add_character_flag = att_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = att_AA
				}
				mother = {
					has_character_flag = att_aa
				}
				}
				add_character_flag = att_Aa
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = att_aa
				}
				mother = {
					has_character_flag = att_AA
				}
				}
				add_character_flag = att_Aa
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = att_Aa
				}
				mother = {
					has_character_flag = att_aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = att_Aa
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = att_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = att_aa
				}
				mother = {
					has_character_flag = att_Aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = att_Aa
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = att_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = att_aa
				}
				mother = {
					has_character_flag = att_aa
				}
				}
				add_character_flag = att_aa
			}
			else = {
				add_character_flag = att_Aa
				change_variable = { name = alleles add = 1 }
			}
		
			if = {
			
				limit = {
					real_father = {
						has_character_flag = att_BB
					}
					mother = {
						has_character_flag = att_BB
					}
				}
				add_character_flag = att_BB
				change_variable = { name = alleles add = 2 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_BB
					}
					mother = {
						has_character_flag = att_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = att_BB
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = att_Bb
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_Bb
					}
					mother = {
						has_character_flag = att_BB
					}
				}
				random_list = {
				50 = {
				add_character_flag = att_BB
				change_variable = { name = alleles add = 2 }

				}
				50 = {
				add_character_flag = att_Bb
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_Bb
					}
					mother = {
						has_character_flag = att_Bb
					}
				}
				random_list = {
				25 = {
				add_character_flag = att_BB
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = att_Bb
				change_variable = { name = alleles add = 1 }
				}
				25 = {
				add_character_flag = att_bb
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_BB
					}
					mother = {
						has_character_flag = att_bb
					}
				}
				add_character_flag = att_Bb
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_bb
					}
					mother = {
						has_character_flag = att_BB
					}
				}
				add_character_flag = att_Bb
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_Bb
					}
					mother = {
						has_character_flag = att_bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = att_Bb
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = att_bb
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_bb
					}
					mother = {
						has_character_flag = att_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = att_Bb
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = att_bb
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_bb
					}
					mother = {
						has_character_flag = att_bb
					}
				}
				add_character_flag = att_bb
			}
			else = {
				add_character_flag = att_Bb
				change_variable = { name = alleles add = 1 }
			}

			if = {
			
				limit = {
					real_father = {
						has_character_flag = att_CC
					}
					mother = {
						has_character_flag = att_CC
					}
				}
				add_character_flag = att_CC
				change_variable = { name = alleles add = 2 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_CC
					}
					mother = {
						has_character_flag = att_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = att_CC
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = att_Cc
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_Cc
					}
					mother = {
						has_character_flag = att_CC
					}
				}
				random_list = {
				50 = {
				add_character_flag = att_CC
				change_variable = { name = alleles add = 2 }

				}
				50 = {
				add_character_flag = att_Cc
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_Cc
					}
					mother = {
						has_character_flag = att_Cc
					}
				}
				random_list = {
				25 = {
				add_character_flag = att_CC
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = att_Cc
				change_variable = { name = alleles add = 1 }
				}
				25 = {
				add_character_flag = att_cc
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_CC
					}
					mother = {
						has_character_flag = att_cc
					}
				}
				add_character_flag = att_Cc
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_cc
					}
					mother = {
						has_character_flag = att_CC
					}
				}
				add_character_flag = att_Cc
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_Cc
					}
					mother = {
						has_character_flag = att_cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = att_Cc
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = att_cc
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_cc
					}
					mother = {
						has_character_flag = att_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = att_Cc
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = att_cc
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = att_cc
					}
					mother = {
						has_character_flag = att_cc
					}
				}
				add_character_flag = att_cc
			}
			else = {
				add_character_flag = att_Cc
				change_variable = { name = alleles add = 1 }
			}
		
		## 3. Mutation
			if = {
				limit = {
					exists = dynasty
					dynasty = {
							has_dynasty_perk = blood_legacy_1
						}
				}
				if = {
					limit = {
						has_character_flag = att_Aa
					}
					random_list = {
						0 = {
							modifier = {
								exists = dynasty
								dynasty = {
									has_dynasty_perk = blood_legacy_1
								}
								add = 25
							}
							add_character_flag = is_blood_legacy_working_as_intended
							remove_character_flag = att_Aa
							add_character_flag = att_AA
							change_variable = { name = alleles add = 1 }
						}
						975 = {

						}
					}
				}
				if = {
					limit = {
						has_character_flag = att_Bb
					}
					random_list = {
						0 = {
							modifier = {
								exists = dynasty
								dynasty = {
									has_dynasty_perk = blood_legacy_1
								}
								add = 25
							}
							remove_character_flag = att_Bb
							add_character_flag = att_BB
							change_variable = { name = alleles add = 1 }
						}
						975 = {

						}
					}
				}
				if = {
					limit = {
						has_character_flag = att_Cc
					}
					random_list = {
						0 = {
							modifier = {
								exists = dynasty
								dynasty = {
									has_dynasty_perk = blood_legacy_1
								}
								add = 25
							}
							remove_character_flag = att_Aa
							add_character_flag = att_AA
							change_variable = { name = alleles add = 1 }
						}
						975 = {

						}
					}
				}

			}

		## 4. Phenotype to genotype conversion
			if = {
				limit = {
					var:alleles >= 6
					NOT = {
						OR = {
							has_trait = beauty_good_3
							has_trait = beauty_good_2
							has_trait = beauty_bad_3
							has_trait = beauty_bad_2
							has_trait = beauty_good_1
							has_trait = beauty_bad_1
						}
					}
				}
				random_list = {
					35 = {
						modifier = {
							exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 20
						}
						add_trait = beauty_good_3
					}
					55 = {
						add_trait = beauty_good_2
					}
					10 = {
						add_trait = beauty_good_1
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 5
					NOT = {
						OR = {
							has_trait = beauty_good_3
							has_trait = beauty_good_2
							has_trait = beauty_bad_3
							has_trait = beauty_bad_2
							has_trait = beauty_good_1
							has_trait = beauty_bad_1
						}
					}
				}
				random_list = {
					1 = {
						modifier = {
							exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 5
						}
						add_trait = beauty_good_3
					}
					17 = {
						modifier = {
							exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 10
						}
						add_trait = beauty_good_2
					}
					45 = {
						add_trait = beauty_good_1
					}
					39 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 4
					NOT = {
						OR = {
							has_trait = beauty_good_3
							has_trait = beauty_good_2
							has_trait = beauty_bad_3
							has_trait = beauty_bad_2
							has_trait = beauty_good_1
							has_trait = beauty_bad_1
						}
					}
				}
				random_list = {
					4 = {
						modifier = {
							exists = dynasty
							dynasty = {
									has_dynasty_perk = blood_legacy_2
								}
							add = 20
						}
						modifier = {
								exists = dynasty
							dynasty = {
								exists = var:blood_legacy_4_beauty_good_1
							}
							add = 90
						}
						add_trait = beauty_good_1
					}
					196 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 3
					NOT = {
						OR = {
							has_trait = beauty_good_3
							has_trait = beauty_good_2
							has_trait = beauty_bad_3
							has_trait = beauty_bad_2
							has_trait = beauty_good_1
							has_trait = beauty_bad_1
						}
					}
				}
				random_list = {
					0 = {
						modifier = {
							exists = dynasty
							dynasty = {
									exists = var:blood_legacy_4_beauty_good_1
							}
							add = 15
						}
						add_trait = beauty_good_1
					}
					90 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 2
					NOT = {
						OR = {
							has_trait = beauty_good_3
							has_trait = beauty_good_2
							has_trait = beauty_bad_3
							has_trait = beauty_bad_2
							has_trait = beauty_good_1
							has_trait = beauty_bad_1
						}
					}
				}
				random_list = {
					4 = {
					add_trait = beauty_bad_1
					}
					196 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 1
					NOT = {
						OR = {
							has_trait = beauty_good_3
							has_trait = beauty_good_2
							has_trait = beauty_bad_3
							has_trait = beauty_bad_2
							has_trait = beauty_good_1
							has_trait = beauty_bad_1
						}
					}
				}
				random_list = {
					1 = {
					add_trait = beauty_bad_3
					}
					15 = {
					add_trait = beauty_bad_2
					}
					42 = {
					add_trait = beauty_bad_1
					}
					42 = {
					}
				}
			}
			else_if = {
				limit = {
					var:alleles = 0
					NOT = {
						OR = {
							has_trait = beauty_good_3
							has_trait = beauty_good_2
							has_trait = beauty_bad_3
							has_trait = beauty_bad_2
							has_trait = beauty_good_1
							has_trait = beauty_bad_1
						}
					}
				}
				random_list = {
					35 = {
					add_trait = beauty_bad_3
					}
					55 = {
					add_trait = beauty_bad_2
					}
					10 = {
					add_trait = beauty_bad_1
					}
				}
			}
			else = {
			}
	}
}

## GIANT - Single Dominant. Double dominant leads to death
IG.104 = {
	type = character_event
	hidden = yes

	immediate = {	
		## 1. Initialization. Only executes if parents have no flags
			if = {
				limit = {
					real_father = {
						NOR = {
							has_character_flag = giant_AA
							has_character_flag = giant_Aa
							has_character_flag = giant_aa
						}
					}
				}
				real_father = {
					if = {
						limit = {
							has_trait = giant
						}
						add_character_flag = giant_Aa
					}
					else = {
						add_character_flag = giant_aa
					}
				}
			}
			if = {
				limit = {
					mother = {
						NOR = {
							has_character_flag = giant_AA
							has_character_flag = giant_Aa
							has_character_flag = giant_aa
						}
					}
				}
				mother = {
					if = {
						limit = {
							has_trait = giant
						}
						add_character_flag = giant_Aa
					}
					else = {
						add_character_flag = giant_aa
					}
				}
			}
			
		## 3. Punnett Square
			set_variable = { name = alleles value = 0 }
			
			if = {
			
				limit = {
					real_father = {
						has_character_flag = giant_AA
					}
					mother = {
						has_character_flag = giant_AA
					}
				}
				add_character_flag = giant_AA
				change_variable = { name = alleles add = 2 }
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = giant_AA
					}
					mother = {
						has_character_flag = giant_Aa
					}
				}
				random_list = {
				50 = {
				add_character_flag = giant_AA
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = giant_Aa
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = giant_Aa
				}
				mother = {
					has_character_flag = giant_AA
				}
				}
				random_list = {
				50 = {
				add_character_flag = giant_AA
				change_variable = { name = alleles add = 2 }

				}
				50 = {
				add_character_flag = giant_Aa
				change_variable = { name = alleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = giant_Aa
				}
				mother = {
					has_character_flag = giant_Aa
				}
				}
				random_list = {
				25 = {
				add_character_flag = giant_AA
				change_variable = { name = alleles add = 2 }
				}
				50 = {
				add_character_flag = giant_Aa
				change_variable = { name = alleles add = 1 }
				}
				25 = {
				add_character_flag = giant_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = giant_AA
				}
				mother = {
					has_character_flag = giant_aa
				}
				}
				add_character_flag = giant_Aa
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = giant_aa
				}
				mother = {
					has_character_flag = giant_AA
				}
				}
				add_character_flag = giant_Aa
				change_variable = { name = alleles add = 1 }
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = giant_Aa
				}
				mother = {
					has_character_flag = giant_aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = giant_Aa
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = giant_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = giant_aa
				}
				mother = {
					has_character_flag = giant_Aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = giant_Aa
				change_variable = { name = alleles add = 1 }
				}
				50 = {
				add_character_flag = giant_aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = giant_aa
				}
				mother = {
					has_character_flag = giant_aa
				}
				}
				add_character_flag = giant_aa
			}
			else = {
				add_character_flag = giant_aa
			}

		## 3. Gene Mutation

			scope:mother = {
				save_temporary_scope_as = compare_character
			}

			set_variable = { name = mutation value = 4 }


				if = {
					limit = {
						exists = dynasty
						dynasty = {
							exists = var:blood_legacy_4_giant
						}
					}
					add_character_flag = bloodlegacyworks
					change_variable = { name = mutation add = 150 }
				}

			if = {
				limit = {
					has_character_flag = giant_aa
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
							}
						}
						remove_character_flag = giant_aa
						add_character_flag = giant_Aa
						change_variable = { name = alleles add = 1 }
					}
					997 = {

					}
				}
			}
			
		## 4. Phenotype to genotype conversion
			if = {
				limit = {
					var:alleles = 2
					NOR = {
						has_trait = tall
						has_trait = short
						has_trait = giant
						has_trait = dwarf
						has_trait = towering
						has_trait = tiny
					}
				}
				add_trait = giant
			}
			else_if = {
				limit = {
					var:alleles = 1
					NOR = {
						has_trait = tall
						has_trait = short
						has_trait = giant
						has_trait = dwarf
						has_trait = towering
						has_trait = tiny
					}
				}
				add_trait = giant
			}
			else = {
			}
	}
}

## CLUBFOOTED - Recessive, 3 alleles
IG.106 = {
	type = character_event
	hidden = yes

	immediate = {		
		## 1. Initialization. Only executes if parents have no flags
			if = {
				limit = {
					real_father = {
						NOR = {
							has_character_flag = clubfoot_AA
							has_character_flag = clubfoot_Aa
							has_character_flag = clubfoot_aa
							has_character_flag = clubfoot_BB
							has_character_flag = clubfoot_Bb
							has_character_flag = clubfoot_bb
							has_character_flag = clubfoot_CC
							has_character_flag = clubfoot_Cc
							has_character_flag = clubfoot_cc
						}
					}
				}
				real_father = {
					if = {
						limit = {
							has_trait = clubfooted
						}
						clubfoot_flag_tgr = yes
					}
					else = {
						average_clubfoot_flag_tgr = yes
					}
				}
			}
			if = {
				limit = {
					mother = {
						NOR = {
							has_character_flag = clubfoot_AA
							has_character_flag = clubfoot_Aa
							has_character_flag = clubfoot_aa
							has_character_flag = clubfoot_BB
							has_character_flag = clubfoot_Bb
							has_character_flag = clubfoot_bb
							has_character_flag = clubfoot_CC
							has_character_flag = clubfoot_Cc
							has_character_flag = clubfoot_cc
						}
					}
				}
				mother = {
					if = {
						limit = {
							has_trait = clubfooted
						}
						clubfoot_flag_tgr = yes
					}
					else = {
						average_clubfoot_flag_tgr = yes
					}
				}
			}
			
		## 2. Punnett Square
			set_variable = { name = ralleles value = 0 }
			
			if = {
			
				limit = {
					real_father = {
						has_character_flag = clubfoot_AA
					}
					mother = {
						has_character_flag = clubfoot_AA
					}
				}
				add_character_flag = clubfoot_AA
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = clubfoot_AA
					}
					mother = {
						has_character_flag = clubfoot_Aa
					}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_AA
				}
				50 = {
				add_character_flag = clubfoot_Aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_Aa
				}
				mother = {
					has_character_flag = clubfoot_AA
				}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_AA

				}
				50 = {
				add_character_flag = clubfoot_Aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_Aa
				}
				mother = {
					has_character_flag = clubfoot_Aa
				}
				}
				random_list = {
				25 = {
				add_character_flag = clubfoot_AA
				}
				50 = {
				add_character_flag = clubfoot_Aa
				}
				25 = {
				add_character_flag = clubfoot_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_AA
				}
				mother = {
					has_character_flag = clubfoot_aa
				}
				}
				add_character_flag = clubfoot_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_aa
				}
				mother = {
					has_character_flag = clubfoot_AA
				}
				}
				add_character_flag = clubfoot_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_Aa
				}
				mother = {
					has_character_flag = clubfoot_aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_Aa
				}
				50 = {
				add_character_flag = clubfoot_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_aa
				}
				mother = {
					has_character_flag = clubfoot_Aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_Aa
				}
				50 = {
				add_character_flag = clubfoot_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_aa
				}
				mother = {
					has_character_flag = clubfoot_aa
				}
				}
				add_character_flag = clubfoot_aa
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = clubfoot_Aa
			}
			
			if = {
				limit = {
					real_father = {
						has_character_flag = clubfoot_BB
					}
					mother = {
						has_character_flag = clubfoot_BB
					}
				}
				add_character_flag = clubfoot_BB
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = clubfoot_BB
					}
					mother = {
						has_character_flag = clubfoot_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_BB
				}
				50 = {
				add_character_flag = clubfoot_Bb
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_Bb
				}
				mother = {
					has_character_flag = clubfoot_BB
				}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_BB

				}
				50 = {
				add_character_flag = clubfoot_Bb
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_Bb
				}
				mother = {
					has_character_flag = clubfoot_Bb
				}
				}
				random_list = {
				25 = {
				add_character_flag = clubfoot_BB
				}
				50 = {
				add_character_flag = clubfoot_Bb
				}
				25 = {
				add_character_flag = clubfoot_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_BB
				}
				mother = {
					has_character_flag = clubfoot_bb
				}
				}
				add_character_flag = clubfoot_Bb
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_bb
				}
				mother = {
					has_character_flag = clubfoot_BB
				}
				}
				add_character_flag = clubfoot_Bb
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_Bb
				}
				mother = {
					has_character_flag = clubfoot_bb
				}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_Bb
				}
				50 = {
				add_character_flag = clubfoot_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_bb
				}
				mother = {
					has_character_flag = clubfoot_Bb
				}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_Bb
				}
				50 = {
				add_character_flag = clubfoot_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_bb
				}
				mother = {
					has_character_flag = clubfoot_bb
				}
				}
				add_character_flag = clubfoot_bb
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = clubfoot_Bb
			}


			if = {
			
				limit = {
					real_father = {
						has_character_flag = clubfoot_CC
					}
					mother = {
						has_character_flag = clubfoot_CC
					}
				}
				add_character_flag = clubfoot_CC
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = clubfoot_CC
					}
					mother = {
						has_character_flag = clubfoot_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_CC
				}
				50 = {
				add_character_flag = clubfoot_Cc
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_Cc
				}
				mother = {
					has_character_flag = clubfoot_CC
				}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_CC

				}
				50 = {
				add_character_flag = clubfoot_Cc
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_Cc
				}
				mother = {
					has_character_flag = clubfoot_Cc
				}
				}
				random_list = {
				25 = {
				add_character_flag = clubfoot_CC
				}
				50 = {
				add_character_flag = clubfoot_Cc
				}
				25 = {
				add_character_flag = clubfoot_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_CC
				}
				mother = {
					has_character_flag = clubfoot_cc
				}
				}
				add_character_flag = clubfoot_Cc
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_cc
				}
				mother = {
					has_character_flag = clubfoot_CC
				}
				}
				add_character_flag = clubfoot_Cc
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_Cc
				}
				mother = {
					has_character_flag = clubfoot_cc
				}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_Cc
				}
				50 = {
				add_character_flag = clubfoot_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_cc
				}
				mother = {
					has_character_flag = clubfoot_Cc
				}
				}
				random_list = {
				50 = {
				add_character_flag = clubfoot_Cc
				}
				50 = {
				add_character_flag = clubfoot_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = clubfoot_cc
				}
				mother = {
					has_character_flag = clubfoot_cc
				}
				}
				add_character_flag = clubfoot_cc
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = clubfoot_Cc
			}

		## 3. Gene Mutation

			scope:mother = {
				save_temporary_scope_as = compare_character
			}

			## Mutation Chance
			set_variable = { name = mutation value = 3 }

			if = {
				limit = {
					father = {
						is_close_family_of_compare_character_trigger = yes
					}
					
				}
				change_variable = { name = mutation multiply = 5 } ## should increase to 15*3 = 45 with the second one! ~5% chance for a mutation.
			}
			if = {
				limit = {
					father = {
						is_close_or_extended_family_of = scope:compare_character
					}
				}
				change_variable = { name = mutation multiply = 3 }
			}
			if = {
				limit = {
					mother = {
						age >= 35
					}
				}
				change_variable = { name = mutation add = 2 }
			}
			if = {
				limit = {
					mother = {
						age >= 40
					}
				}
				change_variable = { name = mutation add = 4 }
			}
			if = {
				limit = {
					mother = {
						age >= 45
					}
				}
				change_variable = { name = mutation add = 6 } ## total chance 10 higher. 1% additional chance of mutation.
			}
			if = {
				limit = {
					father = {
						age >= 40
					}
				}
				change_variable = { name = mutation add = 2 }
			}
			if = {
				limit = {
					father = {
						age >= 50
					}
				}
				change_variable = { name = mutation add = 4 }
			}
			if = {
				limit = {
					father = {
						age >= 60
					}
				}
				change_variable = { name = mutation add = 6 }	## total chance 10 higher. 1% additional chance of mutation.
			}

			## Negative Mutation
			if = {
				limit = {
					has_character_flag = clubfoot_Cc
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
								if = {
									limit = {
										exists = dynasty
										dynasty = {
											has_dynasty_perk = blood_legacy_3
										}
									}
									multiply = 0.05
								}
							}
						}
						remove_character_flag = clubfoot_Cc
						add_character_flag = clubfoot_cc
						change_variable = { name = ralleles add = 1 }
					}
					997 = {

					}
				}
			}

			if = {
				limit = {
					has_character_flag = clubfoot_Bb
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
								if = {
									limit = {
										exists = dynasty
										dynasty = {
											has_dynasty_perk = blood_legacy_3
										}
									}
									multiply = 0.05
								}
							}
						}
						remove_character_flag = clubfoot_Bb
						add_character_flag = clubfoot_bb
						change_variable = { name = ralleles add = 1 }
					}
					997 = {

					}
				}
			}

		## 4. Phenotype to genotype conversion
			if = {
				limit = {
					var:ralleles = 3
					NOT = {
						has_trait = clubfooted
					}
				}
				add_trait = clubfooted
				
			}
			else_if = {
				limit = {
					var:ralleles = 2
					NOT = {
						has_trait = clubfooted
					}
				}
				random_list = {
					30 = {
					add_trait = clubfooted
					}
					70 = {
					}
				}
			}
			else_if = {
				limit = {
					var:ralleles = 1
				}
			}
			else = {
			}
	}
}

## HUNCHBACK - Recessive
IG.107 = {
	type = character_event
	hidden = yes

	immediate = {		
		## 1. Initialization. Only executes if parents have no flags
			if = {
				limit = {
					real_father = {
						NOR = {
							has_character_flag = hunchbacked_AA
							has_character_flag = hunchbacked_Aa
							has_character_flag = hunchbacked_aa
							has_character_flag = hunchbacked_BB
							has_character_flag = hunchbacked_Bb
							has_character_flag = hunchbacked_bb
							has_character_flag = hunchbacked_CC
							has_character_flag = hunchbacked_Cc
							has_character_flag = hunchbacked_cc
						}
					}
				}
				real_father = {
					if = {
						limit = {
							has_trait = hunchbacked
						}
						hunchbacked_flag_tgr = yes
					}
					else = {
						average_hunchbacked_flag_tgr = yes
					}
				}
			}
			if = {
				limit = {
					mother = {
						NOR = {
							has_character_flag = hunchbacked_AA
							has_character_flag = hunchbacked_Aa
							has_character_flag = hunchbacked_aa
							has_character_flag = hunchbacked_BB
							has_character_flag = hunchbacked_Bb
							has_character_flag = hunchbacked_bb
							has_character_flag = hunchbacked_CC
							has_character_flag = hunchbacked_Cc
							has_character_flag = hunchbacked_cc
						}
					}
				}
				mother = {
					if = {
						limit = {
							has_trait = hunchbacked
						}
						hunchbacked_flag_tgr = yes
					}
					else = {
						average_hunchbacked_flag_tgr = yes
					}
				}
			}
			
		## 2. Punnett Square
			set_variable = { name = ralleles value = 0 }
			
			if = {
			
				limit = {
					real_father = {
						has_character_flag = hunchbacked_AA
					}
					mother = {
						has_character_flag = hunchbacked_AA
					}
				}
				add_character_flag = hunchbacked_AA
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = hunchbacked_AA
					}
					mother = {
						has_character_flag = hunchbacked_Aa
					}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_AA
				}
				50 = {
				add_character_flag = hunchbacked_Aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_Aa
				}
				mother = {
					has_character_flag = hunchbacked_AA
				}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_AA

				}
				50 = {
				add_character_flag = hunchbacked_Aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_Aa
				}
				mother = {
					has_character_flag = hunchbacked_Aa
				}
				}
				random_list = {
				25 = {
				add_character_flag = hunchbacked_AA
				}
				50 = {
				add_character_flag = hunchbacked_Aa
				}
				25 = {
				add_character_flag = hunchbacked_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_AA
				}
				mother = {
					has_character_flag = hunchbacked_aa
				}
				}
				add_character_flag = hunchbacked_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_aa
				}
				mother = {
					has_character_flag = hunchbacked_AA
				}
				}
				add_character_flag = hunchbacked_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_Aa
				}
				mother = {
					has_character_flag = hunchbacked_aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_Aa
				}
				50 = {
				add_character_flag = hunchbacked_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_aa
				}
				mother = {
					has_character_flag = hunchbacked_Aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_Aa
				}
				50 = {
				add_character_flag = hunchbacked_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_aa
				}
				mother = {
					has_character_flag = hunchbacked_aa
				}
				}
				add_character_flag = hunchbacked_aa
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = hunchbacked_Aa
			}
			
			if = {
				limit = {
					real_father = {
						has_character_flag = hunchbacked_BB
					}
					mother = {
						has_character_flag = hunchbacked_BB
					}
				}
				add_character_flag = hunchbacked_BB
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = hunchbacked_BB
					}
					mother = {
						has_character_flag = hunchbacked_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_BB
				}
				50 = {
				add_character_flag = hunchbacked_Bb
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_Bb
				}
				mother = {
					has_character_flag = hunchbacked_BB
				}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_BB

				}
				50 = {
				add_character_flag = hunchbacked_Bb
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_Bb
				}
				mother = {
					has_character_flag = hunchbacked_Bb
				}
				}
				random_list = {
				25 = {
				add_character_flag = hunchbacked_BB
				}
				50 = {
				add_character_flag = hunchbacked_Bb
				}
				25 = {
				add_character_flag = hunchbacked_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_BB
				}
				mother = {
					has_character_flag = hunchbacked_bb
				}
				}
				add_character_flag = hunchbacked_Bb
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_bb
				}
				mother = {
					has_character_flag = hunchbacked_BB
				}
				}
				add_character_flag = hunchbacked_Bb
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_Bb
				}
				mother = {
					has_character_flag = hunchbacked_bb
				}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_Bb
				}
				50 = {
				add_character_flag = hunchbacked_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_bb
				}
				mother = {
					has_character_flag = hunchbacked_Bb
				}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_Bb
				}
				50 = {
				add_character_flag = hunchbacked_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_bb
				}
				mother = {
					has_character_flag = hunchbacked_bb
				}
				}
				add_character_flag = hunchbacked_bb
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = hunchbacked_Bb
			}


			if = {
			
				limit = {
					real_father = {
						has_character_flag = hunchbacked_CC
					}
					mother = {
						has_character_flag = hunchbacked_CC
					}
				}
				add_character_flag = hunchbacked_CC
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = hunchbacked_CC
					}
					mother = {
						has_character_flag = hunchbacked_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_CC
				}
				50 = {
				add_character_flag = hunchbacked_Cc
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_Cc
				}
				mother = {
					has_character_flag = hunchbacked_CC
				}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_CC

				}
				50 = {
				add_character_flag = hunchbacked_Cc
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_Cc
				}
				mother = {
					has_character_flag = hunchbacked_Cc
				}
				}
				random_list = {
				25 = {
				add_character_flag = hunchbacked_CC
				}
				50 = {
				add_character_flag = hunchbacked_Cc
				}
				25 = {
				add_character_flag = hunchbacked_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_CC
				}
				mother = {
					has_character_flag = hunchbacked_cc
				}
				}
				add_character_flag = hunchbacked_Cc
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_cc
				}
				mother = {
					has_character_flag = hunchbacked_CC
				}
				}
				add_character_flag = hunchbacked_Cc
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_Cc
				}
				mother = {
					has_character_flag = hunchbacked_cc
				}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_Cc
				}
				50 = {
				add_character_flag = hunchbacked_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_cc
				}
				mother = {
					has_character_flag = hunchbacked_Cc
				}
				}
				random_list = {
				50 = {
				add_character_flag = hunchbacked_Cc
				}
				50 = {
				add_character_flag = hunchbacked_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = hunchbacked_cc
				}
				mother = {
					has_character_flag = hunchbacked_cc
				}
				}
				add_character_flag = hunchbacked_cc
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = hunchbacked_Cc
			}

		## 3. Gene Mutation

			scope:mother = {
				save_temporary_scope_as = compare_character
			}

			## Mutation Chance
			set_variable = { name = mutation value = 3 }

			if = {
				limit = {
					father = {
						is_close_family_of_compare_character_trigger = yes
					}
					
				}
				change_variable = { name = mutation multiply = 5 } ## should increase to 15*3 = 45 with the second one! ~5% chance for a mutation.
			}
			if = {
				limit = {
					father = {
						is_close_or_extended_family_of = scope:compare_character
					}
				}
				change_variable = { name = mutation multiply = 3 }
			}
			if = {
				limit = {
					mother = {
						age >= 35
					}
				}
				change_variable = { name = mutation add = 2 }
			}
			if = {
				limit = {
					mother = {
						age >= 40
					}
				}
				change_variable = { name = mutation add = 4 }
			}
			if = {
				limit = {
					mother = {
						age >= 45
					}
				}
				change_variable = { name = mutation add = 6 } ## total chance 10 higher. 1% additional chance of mutation.
			}
			if = {
				limit = {
					father = {
						age >= 40
					}
				}
				change_variable = { name = mutation add = 2 }
			}
			if = {
				limit = {
					father = {
						age >= 50
					}
				}
				change_variable = { name = mutation add = 4 }
			}
			if = {
				limit = {
					father = {
						age >= 60
					}
				}
				change_variable = { name = mutation add = 6 }	## total chance 10 higher. 1% additional chance of mutation.
			}

			## Negative Mutation
			if = {
				limit = {
					has_character_flag = hunchbacked_Cc
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
								if = {
									limit = {
										exists = dynasty
										dynasty = {
											has_dynasty_perk = blood_legacy_3
										}
									}
									multiply = 0.05
								}
							}
						}
						remove_character_flag = hunchbacked_Cc
						add_character_flag = hunchbacked_cc
						change_variable = { name = ralleles add = 1 }
					}
					997 = {

					}
				}
			}

			if = {
				limit = {
					has_character_flag = hunchbacked_Bb
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
								if = {
									limit = {
										exists = dynasty
										dynasty = {
											has_dynasty_perk = blood_legacy_3
										}
									}
									multiply = 0.05
								}
							}
						}
						remove_character_flag = hunchbacked_Bb
						add_character_flag = hunchbacked_bb
						change_variable = { name = ralleles add = 1 }
					}
					997 = {

					}
				}
			}

		## 4. Phenotype to genotype conversion
			if = {
				limit = {
					var:ralleles = 3
					NOT = {
						has_trait = hunchbacked
					}
				}
				add_trait = hunchbacked
				
			}
			else_if = {
				limit = {
					var:ralleles = 2
					NOT = {
						has_trait = hunchbacked
					}
				}
				random_list = {
					30 = {
					add_trait = hunchbacked
					}
					70 = {
					}
				}
			}
			else_if = {
				limit = {
					var:ralleles = 1
				}
			}
			else = {
			}
	}
}

## LISPING
IG.108 = {
	type = character_event
	hidden = yes

	immediate = {		
		## 1. Initialization. Only executes if parents have no flags
			if = {
				limit = {
					real_father = {
						NOR = {
							has_character_flag = lisping_AA
							has_character_flag = lisping_Aa
							has_character_flag = lisping_aa
							has_character_flag = lisping_BB
							has_character_flag = lisping_Bb
							has_character_flag = lisping_bb
							has_character_flag = lisping_CC
							has_character_flag = lisping_Cc
							has_character_flag = lisping_cc
						}
					}
				}
				real_father = {
					if = {
						limit = {
							has_trait = lisping
						}
						
						lisping_flag_tgr = yes
					}
					else = {
						
						average_lisping_flag_tgr = yes
					}
				}
			}
			if = {
				limit = {
					mother = {
						NOR = {
							has_character_flag = lisping_AA
							has_character_flag = lisping_Aa
							has_character_flag = lisping_aa
							has_character_flag = lisping_BB
							has_character_flag = lisping_Bb
							has_character_flag = lisping_bb
							has_character_flag = lisping_CC
							has_character_flag = lisping_Cc
							has_character_flag = lisping_cc
						}
					}
				}
				mother = {
					if = {
						limit = {
							has_trait = lisping
						}
						
						lisping_flag_tgr = yes
					}
					else = {
						
						average_lisping_flag_tgr = yes
					}
				}
			}
			
		## 2. Punnett Square
			set_variable = { name = ralleles value = 0 }
			
			if = {
			
				limit = {
					real_father = {
						has_character_flag = lisping_AA
					}
					mother = {
						has_character_flag = lisping_AA
					}
				}
				add_character_flag = lisping_AA
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = lisping_AA
					}
					mother = {
						has_character_flag = lisping_Aa
					}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_AA
				}
				50 = {
				add_character_flag = lisping_Aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_Aa
				}
				mother = {
					has_character_flag = lisping_AA
				}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_AA

				}
				50 = {
				add_character_flag = lisping_Aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_Aa
				}
				mother = {
					has_character_flag = lisping_Aa
				}
				}
				random_list = {
				25 = {
				add_character_flag = lisping_AA
				}
				50 = {
				add_character_flag = lisping_Aa
				}
				25 = {
				add_character_flag = lisping_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_AA
				}
				mother = {
					has_character_flag = lisping_aa
				}
				}
				add_character_flag = lisping_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_aa
				}
				mother = {
					has_character_flag = lisping_AA
				}
				}
				add_character_flag = lisping_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_Aa
				}
				mother = {
					has_character_flag = lisping_aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_Aa
				}
				50 = {
				add_character_flag = lisping_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_aa
				}
				mother = {
					has_character_flag = lisping_Aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_Aa
				}
				50 = {
				add_character_flag = lisping_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_aa
				}
				mother = {
					has_character_flag = lisping_aa
				}
				}
				add_character_flag = lisping_aa
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = lisping_Aa
			}
			
			if = {
				limit = {
					real_father = {
						has_character_flag = lisping_BB
					}
					mother = {
						has_character_flag = lisping_BB
					}
				}
				add_character_flag = lisping_BB
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = lisping_BB
					}
					mother = {
						has_character_flag = lisping_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_BB
				}
				50 = {
				add_character_flag = lisping_Bb
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_Bb
				}
				mother = {
					has_character_flag = lisping_BB
				}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_BB

				}
				50 = {
				add_character_flag = lisping_Bb
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_Bb
				}
				mother = {
					has_character_flag = lisping_Bb
				}
				}
				random_list = {
				25 = {
				add_character_flag = lisping_BB
				}
				50 = {
				add_character_flag = lisping_Bb
				}
				25 = {
				add_character_flag = lisping_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_BB
				}
				mother = {
					has_character_flag = lisping_bb
				}
				}
				add_character_flag = lisping_Bb
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_bb
				}
				mother = {
					has_character_flag = lisping_BB
				}
				}
				add_character_flag = lisping_Bb
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_Bb
				}
				mother = {
					has_character_flag = lisping_bb
				}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_Bb
				}
				50 = {
				add_character_flag = lisping_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_bb
				}
				mother = {
					has_character_flag = lisping_Bb
				}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_Bb
				}
				50 = {
				add_character_flag = lisping_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_bb
				}
				mother = {
					has_character_flag = lisping_bb
				}
				}
				add_character_flag = lisping_bb
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = lisping_Bb
			}


			if = {
			
				limit = {
					real_father = {
						has_character_flag = lisping_CC
					}
					mother = {
						has_character_flag = lisping_CC
					}
				}
				add_character_flag = lisping_CC
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = lisping_CC
					}
					mother = {
						has_character_flag = lisping_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_CC
				}
				50 = {
				add_character_flag = lisping_Cc
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_Cc
				}
				mother = {
					has_character_flag = lisping_CC
				}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_CC

				}
				50 = {
				add_character_flag = lisping_Cc
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_Cc
				}
				mother = {
					has_character_flag = lisping_Cc
				}
				}
				random_list = {
				25 = {
				add_character_flag = lisping_CC
				}
				50 = {
				add_character_flag = lisping_Cc
				}
				25 = {
				add_character_flag = lisping_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_CC
				}
				mother = {
					has_character_flag = lisping_cc
				}
				}
				add_character_flag = lisping_Cc
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_cc
				}
				mother = {
					has_character_flag = lisping_CC
				}
				}
				add_character_flag = lisping_Cc
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_Cc
				}
				mother = {
					has_character_flag = lisping_cc
				}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_Cc
				}
				50 = {
				add_character_flag = lisping_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_cc
				}
				mother = {
					has_character_flag = lisping_Cc
				}
				}
				random_list = {
				50 = {
				add_character_flag = lisping_Cc
				}
				50 = {
				add_character_flag = lisping_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = lisping_cc
				}
				mother = {
					has_character_flag = lisping_cc
				}
				}
				add_character_flag = lisping_cc
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = lisping_Cc
			}

		## 3. Gene Mutation

			scope:mother = {
				save_temporary_scope_as = compare_character
			}

			## Mutation Chance
			set_variable = { name = mutation value = 3 }

			if = {
				limit = {
					father = {
						is_close_family_of_compare_character_trigger = yes
					}
					
				}
				change_variable = { name = mutation multiply = 5 } ## should increase to 15*3 = 45 with the second one! ~5% chance for a mutation.
			}
			if = {
				limit = {
					father = {
						is_close_or_extended_family_of = scope:compare_character
					}
				}
				change_variable = { name = mutation multiply = 3 }
			}
			if = {
				limit = {
					mother = {
						age >= 35
					}
				}
				change_variable = { name = mutation add = 2 }
			}
			if = {
				limit = {
					mother = {
						age >= 40
					}
				}
				change_variable = { name = mutation add = 4 }
			}
			if = {
				limit = {
					mother = {
						age >= 45
					}
				}
				change_variable = { name = mutation add = 6 } ## total chance 10 higher. 1% additional chance of mutation.
			}
			if = {
				limit = {
					father = {
						age >= 40
					}
				}
				change_variable = { name = mutation add = 2 }
			}
			if = {
				limit = {
					father = {
						age >= 50
					}
				}
				change_variable = { name = mutation add = 4 }
			}
			if = {
				limit = {
					father = {
						age >= 60
					}
				}
				change_variable = { name = mutation add = 6 }	## total chance 10 higher. 1% additional chance of mutation.
			}

			## Negative Mutation
			if = {
				limit = {
					has_character_flag = lisping_Cc
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
								if = {
									limit = {
										exists = dynasty
										dynasty = {
											has_dynasty_perk = blood_legacy_3
										}
									}
									multiply = 0.05
								}
							}
						}
						remove_character_flag = lisping_Cc
						add_character_flag = lisping_cc
						change_variable = { name = ralleles add = 1 }
					}
					997 = {

					}
				}
			}

			if = {
				limit = {
					has_character_flag = lisping_Bb
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
								if = {
									limit = {
										exists = dynasty
										dynasty = {
											has_dynasty_perk = blood_legacy_3
										}
									}
									multiply = 0.05
								}
							}
						}
						remove_character_flag = lisping_Bb
						add_character_flag = lisping_bb
						change_variable = { name = ralleles add = 1 }
					}
					997 = {

					}
				}
			}

		## 4. Phenotype to genotype conversion
			if = {
				limit = {
					var:ralleles = 3
					NOT = {
						has_trait = lisping
					}
				}
				add_trait = lisping
				
			}
			else_if = {
				limit = {
					var:ralleles = 2
					NOT = {
						has_trait = lisping
					}
				}
				random_list = {
					30 = {
					add_trait = lisping
					}
					70 = {
					}
				}
			}
			else_if = {
				limit = {
					var:ralleles = 1
				}
			}
			else = {
			}
	}
}

## STUTTERING
IG.109 = {
	type = character_event
	hidden = yes

	immediate = {		
		## 1. Initialization. Only executes if parents have no flags
			if = {
				limit = {
					real_father = {
						NOR = {
							has_character_flag = stuttering_AA
							has_character_flag = stuttering_Aa
							has_character_flag = stuttering_aa
							has_character_flag = stuttering_BB
							has_character_flag = stuttering_Bb
							has_character_flag = stuttering_bb
							has_character_flag = stuttering_CC
							has_character_flag = stuttering_Cc
							has_character_flag = stuttering_cc
						}
					}
				}
				real_father = {
					if = {
						limit = {
							has_trait = stuttering
						}
						
						stuttering_flag_tgr = yes
					}
					else = {
						
						average_stuttering_flag_tgr = yes
					}
				}
			}
			if = {
				limit = {
					mother = {
						NOR = {
							has_character_flag = stuttering_AA
							has_character_flag = stuttering_Aa
							has_character_flag = stuttering_aa
							has_character_flag = stuttering_BB
							has_character_flag = stuttering_Bb
							has_character_flag = stuttering_bb
							has_character_flag = stuttering_CC
							has_character_flag = stuttering_Cc
							has_character_flag = stuttering_cc
						}
					}
				}
				mother = {
					if = {
						limit = {
							has_trait = stuttering
						}
						
						stuttering_flag_tgr = yes
					}
					else = {
						
						average_stuttering_flag_tgr = yes
					}
				}
			}
			
		## 2. Punnett Square
			set_variable = { name = ralleles value = 0 }
			
			if = {
			
				limit = {
					real_father = {
						has_character_flag = stuttering_AA
					}
					mother = {
						has_character_flag = stuttering_AA
					}
				}
				add_character_flag = stuttering_AA
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = stuttering_AA
					}
					mother = {
						has_character_flag = stuttering_Aa
					}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_AA
				}
				50 = {
				add_character_flag = stuttering_Aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_Aa
				}
				mother = {
					has_character_flag = stuttering_AA
				}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_AA

				}
				50 = {
				add_character_flag = stuttering_Aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_Aa
				}
				mother = {
					has_character_flag = stuttering_Aa
				}
				}
				random_list = {
				25 = {
				add_character_flag = stuttering_AA
				}
				50 = {
				add_character_flag = stuttering_Aa
				}
				25 = {
				add_character_flag = stuttering_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_AA
				}
				mother = {
					has_character_flag = stuttering_aa
				}
				}
				add_character_flag = stuttering_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_aa
				}
				mother = {
					has_character_flag = stuttering_AA
				}
				}
				add_character_flag = stuttering_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_Aa
				}
				mother = {
					has_character_flag = stuttering_aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_Aa
				}
				50 = {
				add_character_flag = stuttering_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_aa
				}
				mother = {
					has_character_flag = stuttering_Aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_Aa
				}
				50 = {
				add_character_flag = stuttering_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_aa
				}
				mother = {
					has_character_flag = stuttering_aa
				}
				}
				add_character_flag = stuttering_aa
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = stuttering_Aa
			}
			
			if = {
				limit = {
					real_father = {
						has_character_flag = stuttering_BB
					}
					mother = {
						has_character_flag = stuttering_BB
					}
				}
				add_character_flag = stuttering_BB
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = stuttering_BB
					}
					mother = {
						has_character_flag = stuttering_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_BB
				}
				50 = {
				add_character_flag = stuttering_Bb
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_Bb
				}
				mother = {
					has_character_flag = stuttering_BB
				}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_BB

				}
				50 = {
				add_character_flag = stuttering_Bb
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_Bb
				}
				mother = {
					has_character_flag = stuttering_Bb
				}
				}
				random_list = {
				25 = {
				add_character_flag = stuttering_BB
				}
				50 = {
				add_character_flag = stuttering_Bb
				}
				25 = {
				add_character_flag = stuttering_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_BB
				}
				mother = {
					has_character_flag = stuttering_bb
				}
				}
				add_character_flag = stuttering_Bb
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_bb
				}
				mother = {
					has_character_flag = stuttering_BB
				}
				}
				add_character_flag = stuttering_Bb
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_Bb
				}
				mother = {
					has_character_flag = stuttering_bb
				}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_Bb
				}
				50 = {
				add_character_flag = stuttering_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_bb
				}
				mother = {
					has_character_flag = stuttering_Bb
				}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_Bb
				}
				50 = {
				add_character_flag = stuttering_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_bb
				}
				mother = {
					has_character_flag = stuttering_bb
				}
				}
				add_character_flag = stuttering_bb
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = stuttering_Bb
			}


			if = {
			
				limit = {
					real_father = {
						has_character_flag = stuttering_CC
					}
					mother = {
						has_character_flag = stuttering_CC
					}
				}
				add_character_flag = stuttering_CC
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = stuttering_CC
					}
					mother = {
						has_character_flag = stuttering_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_CC
				}
				50 = {
				add_character_flag = stuttering_Cc
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_Cc
				}
				mother = {
					has_character_flag = stuttering_CC
				}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_CC

				}
				50 = {
				add_character_flag = stuttering_Cc
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_Cc
				}
				mother = {
					has_character_flag = stuttering_Cc
				}
				}
				random_list = {
				25 = {
				add_character_flag = stuttering_CC
				}
				50 = {
				add_character_flag = stuttering_Cc
				}
				25 = {
				add_character_flag = stuttering_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_CC
				}
				mother = {
					has_character_flag = stuttering_cc
				}
				}
				add_character_flag = stuttering_Cc
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_cc
				}
				mother = {
					has_character_flag = stuttering_CC
				}
				}
				add_character_flag = stuttering_Cc
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_Cc
				}
				mother = {
					has_character_flag = stuttering_cc
				}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_Cc
				}
				50 = {
				add_character_flag = stuttering_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_cc
				}
				mother = {
					has_character_flag = stuttering_Cc
				}
				}
				random_list = {
				50 = {
				add_character_flag = stuttering_Cc
				}
				50 = {
				add_character_flag = stuttering_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = stuttering_cc
				}
				mother = {
					has_character_flag = stuttering_cc
				}
				}
				add_character_flag = stuttering_cc
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = stuttering_Cc
			}

		## 3. Gene Mutation

			scope:mother = {
				save_temporary_scope_as = compare_character
			}

			## Mutation Chance
			set_variable = { name = mutation value = 3 }

			if = {
				limit = {
					father = {
						is_close_family_of_compare_character_trigger = yes
					}
					
				}
				change_variable = { name = mutation multiply = 5 } ## should increase to 15*3 = 45 with the second one! ~5% chance for a mutation.
			}
			if = {
				limit = {
					father = {
						is_close_or_extended_family_of = scope:compare_character
					}
				}
				change_variable = { name = mutation multiply = 3 }
			}
			if = {
				limit = {
					mother = {
						age >= 35
					}
				}
				change_variable = { name = mutation add = 2 }
			}
			if = {
				limit = {
					mother = {
						age >= 40
					}
				}
				change_variable = { name = mutation add = 4 }
			}
			if = {
				limit = {
					mother = {
						age >= 45
					}
				}
				change_variable = { name = mutation add = 6 } ## total chance 10 higher. 1% additional chance of mutation.
			}
			if = {
				limit = {
					father = {
						age >= 40
					}
				}
				change_variable = { name = mutation add = 2 }
			}
			if = {
				limit = {
					father = {
						age >= 50
					}
				}
				change_variable = { name = mutation add = 4 }
			}
			if = {
				limit = {
					father = {
						age >= 60
					}
				}
				change_variable = { name = mutation add = 6 }	## total chance 10 higher. 1% additional chance of mutation.
			}

			## Negative Mutation
			if = {
				limit = {
					has_character_flag = stuttering_Cc
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
								if = {
									limit = {
										exists = dynasty
										dynasty = {
											has_dynasty_perk = blood_legacy_3
										}
									}
									multiply = 0.05
								}
							}
						}
						remove_character_flag = stuttering_Cc
						add_character_flag = stuttering_cc
						change_variable = { name = ralleles add = 1 }
					}
					997 = {

					}
				}
			}

			if = {
				limit = {
					has_character_flag = stuttering_Bb
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
								if = {
									limit = {
										exists = dynasty
										dynasty = {
											has_dynasty_perk = blood_legacy_3
										}
									}
									multiply = 0.05
								}
							}
						}
						remove_character_flag = stuttering_Bb
						add_character_flag = stuttering_bb
						change_variable = { name = ralleles add = 1 }
					}
					997 = {

					}
				}
			}

		## 4. Phenotype to genotype conversion
			if = {
				limit = {
					var:ralleles = 3
					NOT = {
						has_trait = stuttering
					}
				}
				add_trait = stuttering
				
			}
			else_if = {
				limit = {
					var:ralleles = 2
					NOT = {
						has_trait = stuttering
					}
				}
				random_list = {
					30 = {
					add_trait = stuttering
					}
					70 = {
					}
				}
			}
			else_if = {
				limit = {
					var:ralleles = 1
				}
			}
			else = {
			}
	}
}

## DWARF - Single Dominant. Double dominant leads to death
IG.110 = {
	type = character_event
	hidden = yes

	immediate = {
		
			
	## 2. Initialization. Only executes if parents have no flags
		if = {
			limit = {
				real_father = {
					NOR = {
						has_character_flag = dwarf_AA
						has_character_flag = dwarf_Aa
						has_character_flag = dwarf_aa
					}
				}
			}
			real_father = {
				if = {
					limit = {
						has_trait = dwarf
					}
					add_character_flag = dwarf_Aa
				}
				else = {
					add_character_flag = dwarf_aa
				}
			}
		}
		if = {
			limit = {
				mother = {
					NOR = {
						has_character_flag = dwarf_AA
						has_character_flag = dwarf_Aa
						has_character_flag = dwarf_aa
					}
				}
			}
			mother = {
				if = {
					limit = {
						has_trait = dwarf
					}
					add_character_flag = dwarf_Aa
				}
				else = {
					add_character_flag = dwarf_aa
				}
			}
		}
		
	## 3. Punnett Square
		set_variable = { name = alleles value = 0 }
		
		if = {
		
			limit = {
				real_father = {
					has_character_flag = dwarf_AA
				}
				mother = {
					has_character_flag = dwarf_AA
				}
			}
			add_character_flag = dwarf_AA
			change_variable = { name = alleles add = 2 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = dwarf_AA
				}
				mother = {
					has_character_flag = dwarf_Aa
				}
			}
			random_list = {
			50 = {
			add_character_flag = dwarf_AA
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = dwarf_Aa
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = dwarf_Aa
			}
			mother = {
				has_character_flag = dwarf_AA
			}
			}
			random_list = {
			50 = {
			add_character_flag = dwarf_AA
			change_variable = { name = alleles add = 2 }

			}
			50 = {
			add_character_flag = dwarf_Aa
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = dwarf_Aa
			}
			mother = {
				has_character_flag = dwarf_Aa
			}
			}
			random_list = {
			25 = {
			add_character_flag = dwarf_AA
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = dwarf_Aa
			change_variable = { name = alleles add = 1 }
			}
			25 = {
			add_character_flag = dwarf_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = dwarf_AA
			}
			mother = {
				has_character_flag = dwarf_aa
			}
			}
			add_character_flag = dwarf_Aa
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = dwarf_aa
			}
			mother = {
				has_character_flag = dwarf_AA
			}
			}
			add_character_flag = dwarf_Aa
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = dwarf_Aa
			}
			mother = {
				has_character_flag = dwarf_aa
			}
			}
			random_list = {
			50 = {
			add_character_flag = dwarf_Aa
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = dwarf_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = dwarf_aa
			}
			mother = {
				has_character_flag = dwarf_Aa
			}
			}
			random_list = {
			50 = {
			add_character_flag = dwarf_Aa
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = dwarf_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = dwarf_aa
			}
			mother = {
				has_character_flag = dwarf_aa
			}
			}
			add_character_flag = dwarf_aa
		}
		else = {
			add_character_flag = dwarf_aa
		}


	## Gene Mutation
		scope:mother = {
			save_temporary_scope_as = compare_character
		}

		set_variable = { name = mutation value = 4 }

		if = {
			limit = {
				father = {
					is_close_family_of_compare_character_trigger = yes
				}
				
			}
			change_variable = { name = mutation multiply = 4 } ## should increase to 15*3 = 45 with the second one! ~5% chance for a mutation.
		}
		if = {
			limit = {
				father = {
					is_close_or_extended_family_of = scope:compare_character
				}
			}
			change_variable = { name = mutation multiply = 2 }
		}

		if = {
			limit = {
				exists = dynasty
				dynasty = {
					exists = var:blood_legacy_4_dwarf
				}
			}
			add_character_flag = bloodlegacyworksd
			change_variable = { name = mutation add = 150 }
		}

		if = {
			limit = {
				has_character_flag = dwarf_aa
			}
			random_list = {
				0 = {
					modifier = {
						add = { 
							value = var:mutation
						}
					}
					remove_character_flag = dwarf_aa
					add_character_flag = dwarf_Aa
					change_variable = { name = alleles add = 1 }
				}
				997 = {

				}
			}
		}
		
	#4. Phenotype to genotype conversion
		if = {
			limit = {
				var:alleles = 2
				NOR = {
					has_trait = tall
					has_trait = short
					has_trait = giant
					has_trait = dwarf
				}
			}
			add_trait = dwarf
			add_trait = incapable
		}
		else_if = {
			limit = {
				var:alleles = 1
				NOR = {
					has_trait = tall
					has_trait = short
					has_trait = giant
					has_trait = dwarf
				}
			}
			add_trait = dwarf
		}
		else = {
		}
	}
}

## MARFANS SYNDROME - Single Dominant. 
IG.111 = {
	type = character_event
	hidden = yes

	immediate = {
		## To deal with the bastard case since real_real_father is broken
		
			
		## 2. Initialization. Only executes if parents have no flags
		if = {
			limit = {
				real_father = {
					NOR = {
						has_character_flag = spindly_AA
						has_character_flag = spindly_Aa
						has_character_flag = spindly_aa
					}
				}
			}
			real_father = {
				if = {
					limit = {
						has_trait = spindly
					}
					random_list = {
						1 = {
							add_character_flag = spindly_AA
						}
						4 = {
							add_character_flag = spindly_Aa
						}
					}
				}
				else = {
					add_character_flag = spindly_aa
				}
			}
		}
		if = {
			limit = {
				mother = {
					NOR = {
						has_character_flag = spindly_AA
						has_character_flag = spindly_Aa
						has_character_flag = spindly_aa
					}
				}
			}
			mother = {
				if = {
					limit = {
						has_trait = spindly
					}
					random_list = {
						1 = {
							add_character_flag = spindly_AA
						}
						4 = {
							add_character_flag = spindly_Aa
						}
					}
				}
				else = {
					add_character_flag = spindly_aa
				}
			}
		}



		
		
		## 3. Punnett Square
		set_variable = { name = alleles value = 0 }
		
		if = {
		
			limit = {
				real_father = {
					has_character_flag = spindly_AA
				}
				mother = {
					has_character_flag = spindly_AA
				}
			}
			add_character_flag = spindly_AA
			change_variable = { name = alleles add = 2 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = spindly_AA
				}
				mother = {
					has_character_flag = spindly_Aa
				}
			}
			random_list = {
			50 = {
			add_character_flag = spindly_AA
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = spindly_Aa
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = spindly_Aa
			}
			mother = {
				has_character_flag = spindly_AA
			}
			}
			random_list = {
			50 = {
			add_character_flag = spindly_AA
			change_variable = { name = alleles add = 2 }

			}
			50 = {
			add_character_flag = spindly_Aa
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = spindly_Aa
			}
			mother = {
				has_character_flag = spindly_Aa
			}
			}
			random_list = {
			25 = {
			add_character_flag = spindly_AA
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = spindly_Aa
			change_variable = { name = alleles add = 1 }
			}
			25 = {
			add_character_flag = spindly_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = spindly_AA
			}
			mother = {
				has_character_flag = spindly_aa
			}
			}
			add_character_flag = spindly_Aa
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = spindly_aa
			}
			mother = {
				has_character_flag = spindly_AA
			}
			}
			add_character_flag = spindly_Aa
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = spindly_Aa
			}
			mother = {
				has_character_flag = spindly_aa
			}
			}
			random_list = {
			50 = {
			add_character_flag = spindly_Aa
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = spindly_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = spindly_aa
			}
			mother = {
				has_character_flag = spindly_Aa
			}
			}
			random_list = {
			50 = {
			add_character_flag = spindly_Aa
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = spindly_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = spindly_aa
			}
			mother = {
				has_character_flag = spindly_aa
			}
			}
			add_character_flag = spindly_aa
		}
		else = {
			add_character_flag = spindly_aa
		}

		## Mutation 
		if = {
			limit = {
				has_character_flag = spindly_aa
			}
			random_list = {
				3 = {
					remove_character_flag = spindly_aa
					add_character_flag = spindly_Aa
					change_variable = { name = alleles add = 1 }
				}
				997 = {

				}
			}
		}

		#4. Phenotype to genotype conversion
		if = {
			limit = {
				var:alleles >= 1
				NOT = {
					has_trait = spindly
				}
			}
			add_trait = spindly
		}
		else = {
		}
	}
}

## Albino - Recessive. 1 allele. 
IG.112 = {
	type = character_event
	hidden = yes

	immediate = {
		## To deal with the bastard case since real_real_father is broken
		
			
		## 2. Initialization. Only executes if parents have no flags
		if = {
			limit = {
				real_father = {
					NOR = {
						has_character_flag = albino_AA
						has_character_flag = albino_Aa
						has_character_flag = albino_aa
					}
				}
			}
			real_father = {
				if = {
					limit = {
						has_trait = albino
					}
					add_character_flag = albino_aa
				}
				else = {
					random_list = {
						17 = {
							add_character_flag = albino_AA
						}
						3 = {
							add_character_flag = albino_Aa
						}
					}
				}
			}
		}
		if = {
			limit = {
				mother = {
					NOR = {
						has_character_flag = albino_AA
						has_character_flag = albino_Aa
						has_character_flag = albino_aa
					}
				}
			}
			mother = {
				if = {
					limit = {
						has_trait = albino
					}
					add_character_flag = albino_aa
				}
				else = {
					random_list = {
						17 = {
							add_character_flag = albino_AA
						}
						3 = {
							add_character_flag = albino_Aa
						}
					}
				}
			}
		}



		
		
		## 3. Punnett Square
		set_variable = { name = ralleles value = 0 }
		
		if = {
		
			limit = {
				real_father = {
					has_character_flag = albino_AA
				}
				mother = {
					has_character_flag = albino_AA
				}
			}
			add_character_flag = albino_AA
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = albino_AA
				}
				mother = {
					has_character_flag = albino_Aa
				}
			}
			random_list = {
			50 = {
			add_character_flag = albino_AA
			}
			50 = {
			add_character_flag = albino_Aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = albino_Aa
			}
			mother = {
				has_character_flag = albino_AA
			}
			}
			random_list = {
			50 = {
			add_character_flag = albino_AA

			}
			50 = {
			add_character_flag = albino_Aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = albino_Aa
			}
			mother = {
				has_character_flag = albino_Aa
			}
			}
			random_list = {
			25 = {
			add_character_flag = albino_AA
			}
			50 = {
			add_character_flag = albino_Aa
			}
			25 = {
			add_character_flag = albino_aa
			change_variable = { name = ralleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = albino_AA
			}
			mother = {
				has_character_flag = albino_aa
			}
			}
			add_character_flag = albino_Aa
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = albino_aa
			}
			mother = {
				has_character_flag = albino_AA
			}
			}
			add_character_flag = albino_Aa
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = albino_Aa
			}
			mother = {
				has_character_flag = albino_aa
			}
			}
			random_list = {
			50 = {
			add_character_flag = albino_Aa
			}
			50 = {
			add_character_flag = albino_aa
			change_variable = { name = ralleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = albino_aa
			}
			mother = {
				has_character_flag = albino_Aa
			}
			}
			random_list = {
			50 = {
			add_character_flag = albino_Aa
			}
			50 = {
			add_character_flag = albino_aa
			change_variable = { name = ralleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = albino_aa
			}
			mother = {
				has_character_flag = albino_aa
			}
			}
			add_character_flag = albino_aa
			change_variable = { name = ralleles add = 1 }
		}
		else = {
			add_character_flag = albino_AA
		}

		## Mutation 


		scope:mother = {
			save_temporary_scope_as = compare_character
		}

		set_variable = { name = mutation value = 20 }

		if = {
			limit = {
				exists = dynasty
				dynasty = {
					exists = var:blood_legacy_4_albino
				}
			}
			add_character_flag = bloodlegacyworksal
			change_variable = { name = mutation add = 250 }
		}

		if = {
			limit = {
				has_character_flag = albino_Aa
			}
			random_list = {
				0 = {
					modifier = {
						add = { 
							value = var:mutation
						}
					}
					remove_character_flag = albino_Aa
					add_character_flag = albino_aa
					change_variable = { name = ralleles add = 1 }
				}
				997 = {

				}
			}
		}

		if = {
			limit = {
				has_character_flag = albino_AA
			}
			random_list = {
				0 = {
					modifier = {
						add = { 
							value = var:mutation
						}
					}
					remove_character_flag = albino_AA
					add_character_flag = albino_Aa
				}
				997 = {

				}
			}
		}


		#4. Phenotype to genotype conversion
		if = {
			limit = {
				var:ralleles >= 1
				NOT = {
					has_trait = albino
				}
			}
			add_trait = albino
		}
		else = {
		}
	}
}

## ASTHMA - Recessive.
## CLUBFOOTED - Recessive, 3 alleles
IG.113 = {
	type = character_event
	hidden = yes

	immediate = {		
		## 1. Initialization. Only executes if parents have no flags
			if = {
				limit = {
					real_father = {
						NOR = {
							has_character_flag = wheezing_AA
							has_character_flag = wheezing_Aa
							has_character_flag = wheezing_aa
							has_character_flag = wheezing_BB
							has_character_flag = wheezing_Bb
							has_character_flag = wheezing_bb
							has_character_flag = wheezing_CC
							has_character_flag = wheezing_Cc
							has_character_flag = wheezing_cc
						}
					}
				}
				real_father = {
					if = {
						limit = {
							has_trait = wheezing
						}
						
						wheezing_flag_tgr = yes
					}
					else = {
						
						average_wheezing_flag_tgr = yes
					}
				}
			}
			if = {
				limit = {
					mother = {
						NOR = {
							has_character_flag = wheezing_AA
							has_character_flag = wheezing_Aa
							has_character_flag = wheezing_aa
							has_character_flag = wheezing_BB
							has_character_flag = wheezing_Bb
							has_character_flag = wheezing_bb
							has_character_flag = wheezing_CC
							has_character_flag = wheezing_Cc
							has_character_flag = wheezing_cc
						}
					}
				}
				mother = {
					if = {
						limit = {
							has_trait = wheezing
						}
						
						wheezing_flag_tgr = yes
					}
					else = {
						
						average_wheezing_flag_tgr = yes
					}
				}
			}
			
		## 2. Punnett Square
			set_variable = { name = ralleles value = 0 }
			
			if = {
			
				limit = {
					real_father = {
						has_character_flag = wheezing_AA
					}
					mother = {
						has_character_flag = wheezing_AA
					}
				}
				add_character_flag = wheezing_AA
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = wheezing_AA
					}
					mother = {
						has_character_flag = wheezing_Aa
					}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_AA
				}
				50 = {
				add_character_flag = wheezing_Aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_Aa
				}
				mother = {
					has_character_flag = wheezing_AA
				}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_AA

				}
				50 = {
				add_character_flag = wheezing_Aa
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_Aa
				}
				mother = {
					has_character_flag = wheezing_Aa
				}
				}
				random_list = {
				25 = {
				add_character_flag = wheezing_AA
				}
				50 = {
				add_character_flag = wheezing_Aa
				}
				25 = {
				add_character_flag = wheezing_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_AA
				}
				mother = {
					has_character_flag = wheezing_aa
				}
				}
				add_character_flag = wheezing_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_aa
				}
				mother = {
					has_character_flag = wheezing_AA
				}
				}
				add_character_flag = wheezing_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_Aa
				}
				mother = {
					has_character_flag = wheezing_aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_Aa
				}
				50 = {
				add_character_flag = wheezing_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_aa
				}
				mother = {
					has_character_flag = wheezing_Aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_Aa
				}
				50 = {
				add_character_flag = wheezing_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_aa
				}
				mother = {
					has_character_flag = wheezing_aa
				}
				}
				add_character_flag = wheezing_aa
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = wheezing_Aa
			}
			
			if = {
				limit = {
					real_father = {
						has_character_flag = wheezing_BB
					}
					mother = {
						has_character_flag = wheezing_BB
					}
				}
				add_character_flag = wheezing_BB
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = wheezing_BB
					}
					mother = {
						has_character_flag = wheezing_Bb
					}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_BB
				}
				50 = {
				add_character_flag = wheezing_Bb
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_Bb
				}
				mother = {
					has_character_flag = wheezing_BB
				}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_BB

				}
				50 = {
				add_character_flag = wheezing_Bb
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_Bb
				}
				mother = {
					has_character_flag = wheezing_Bb
				}
				}
				random_list = {
				25 = {
				add_character_flag = wheezing_BB
				}
				50 = {
				add_character_flag = wheezing_Bb
				}
				25 = {
				add_character_flag = wheezing_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_BB
				}
				mother = {
					has_character_flag = wheezing_bb
				}
				}
				add_character_flag = wheezing_Bb
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_bb
				}
				mother = {
					has_character_flag = wheezing_BB
				}
				}
				add_character_flag = wheezing_Bb
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_Bb
				}
				mother = {
					has_character_flag = wheezing_bb
				}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_Bb
				}
				50 = {
				add_character_flag = wheezing_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_bb
				}
				mother = {
					has_character_flag = wheezing_Bb
				}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_Bb
				}
				50 = {
				add_character_flag = wheezing_bb
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_bb
				}
				mother = {
					has_character_flag = wheezing_bb
				}
				}
				add_character_flag = wheezing_bb
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = wheezing_Bb
			}


			if = {
			
				limit = {
					real_father = {
						has_character_flag = wheezing_CC
					}
					mother = {
						has_character_flag = wheezing_CC
					}
				}
				add_character_flag = wheezing_CC
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = wheezing_CC
					}
					mother = {
						has_character_flag = wheezing_Cc
					}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_CC
				}
				50 = {
				add_character_flag = wheezing_Cc
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_Cc
				}
				mother = {
					has_character_flag = wheezing_CC
				}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_CC

				}
				50 = {
				add_character_flag = wheezing_Cc
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_Cc
				}
				mother = {
					has_character_flag = wheezing_Cc
				}
				}
				random_list = {
				25 = {
				add_character_flag = wheezing_CC
				}
				50 = {
				add_character_flag = wheezing_Cc
				}
				25 = {
				add_character_flag = wheezing_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_CC
				}
				mother = {
					has_character_flag = wheezing_cc
				}
				}
				add_character_flag = wheezing_Cc
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_cc
				}
				mother = {
					has_character_flag = wheezing_CC
				}
				}
				add_character_flag = wheezing_Cc
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_Cc
				}
				mother = {
					has_character_flag = wheezing_cc
				}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_Cc
				}
				50 = {
				add_character_flag = wheezing_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_cc
				}
				mother = {
					has_character_flag = wheezing_Cc
				}
				}
				random_list = {
				50 = {
				add_character_flag = wheezing_Cc
				}
				50 = {
				add_character_flag = wheezing_cc
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = wheezing_cc
				}
				mother = {
					has_character_flag = wheezing_cc
				}
				}
				add_character_flag = wheezing_cc
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = wheezing_Cc
			}

		## 3. Gene Mutation

			scope:mother = {
				save_temporary_scope_as = compare_character
			}

			## Mutation Chance
			set_variable = { name = mutation value = 3 }

			if = {
				limit = {
					father = {
						is_close_family_of_compare_character_trigger = yes
					}
					
				}
				change_variable = { name = mutation multiply = 5 } ## should increase to 15*3 = 45 with the second one! ~5% chance for a mutation.
			}
			if = {
				limit = {
					father = {
						is_close_or_extended_family_of = scope:compare_character
					}
				}
				change_variable = { name = mutation multiply = 3 }
			}
			if = {
				limit = {
					mother = {
						age >= 35
					}
				}
				change_variable = { name = mutation add = 2 }
			}
			if = {
				limit = {
					mother = {
						age >= 40
					}
				}
				change_variable = { name = mutation add = 4 }
			}
			if = {
				limit = {
					mother = {
						age >= 45
					}
				}
				change_variable = { name = mutation add = 6 } ## total chance 10 higher. 1% additional chance of mutation.
			}
			if = {
				limit = {
					father = {
						age >= 40
					}
				}
				change_variable = { name = mutation add = 2 }
			}
			if = {
				limit = {
					father = {
						age >= 50
					}
				}
				change_variable = { name = mutation add = 4 }
			}
			if = {
				limit = {
					father = {
						age >= 60
					}
				}
				change_variable = { name = mutation add = 6 }	## total chance 10 higher. 1% additional chance of mutation.
			}

			## Negative Mutation
			if = {
				limit = {
					has_character_flag = wheezing_Cc
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
								if = {
									limit = {
										exists = dynasty
										dynasty = {
											has_dynasty_perk = blood_legacy_3
										}
									}
									multiply = 0.05
								}
							}
						}
						remove_character_flag = wheezing_Cc
						add_character_flag = wheezing_cc
						change_variable = { name = ralleles add = 1 }
					}
					997 = {

					}
				}
			}

			if = {
				limit = {
					has_character_flag = wheezing_Bb
				}
				random_list = {
					0 = {
						modifier = {
							add = { 
								value = var:mutation
								if = {
									limit = {
										exists = dynasty
										dynasty = {
											has_dynasty_perk = blood_legacy_3
										}
									}
									multiply = 0.05
								}
							}
						}
						remove_character_flag = wheezing_Bb
						add_character_flag = wheezing_bb
						change_variable = { name = ralleles add = 1 }
					}
					997 = {

					}
				}
			}

		## 4. Phenotype to genotype conversion
			if = {
				limit = {
					var:ralleles = 3
					NOT = {
						has_trait = wheezing
					}
				}
				add_trait = wheezing
				
			}
			else_if = {
				limit = {
					var:ralleles = 2
					NOT = {
						has_trait = wheezing
					}
				}
				random_list = {
					30 = {
					add_trait = wheezing
					}
					70 = {
					}
				}
			}
			else_if = {
				limit = {
					var:ralleles = 1
				}
			}
			else = {
			}
	}
}

## Height
IG.117 = {
	type = character_event
	hidden = yes

	immediate = {
		## To deal with the bastard case since real_real_father is broken
		
			
		## 2. Initialization. Only executes if parents have no flags
		if = {
			limit = {
				real_father = {
					NOR = {
						has_character_flag = hgt_AA
						has_character_flag = hgt_Aa
						has_character_flag = hgt_aa
						has_character_flag = hgt_BB
						has_character_flag = hgt_Bb
						has_character_flag = hgt_bb
						has_character_flag = hgt_CC
						has_character_flag = hgt_Cc
						has_character_flag = hgt_cc
					}
				}
			}
			real_father = {
				if = {
					limit = {
						has_trait = towering
					}
					hgt_4_flag_tgr = yes
				}
				else_if = {
					limit = {
						has_trait = tall
					}
					hgt_3_flag_tgr = yes
				}
				else_if = {
					limit = {
						has_trait = short
					}
					hgt_2_flag_tgr = yes
				}
				else_if = {
					limit = {
						has_trait = tiny
					}
					hgt_1_flag_tgr = yes
				}
				else = {
					average_hgt_flag_tgr = yes
				}
			}
		}
		if = {
			limit = {
				mother = {
					NOR = {
						has_character_flag = hgt_AA
						has_character_flag = hgt_Aa
						has_character_flag = hgt_aa
						has_character_flag = hgt_BB
						has_character_flag = hgt_Bb
						has_character_flag = hgt_bb
						has_character_flag = hgt_CC
						has_character_flag = hgt_Cc
						has_character_flag = hgt_cc
					}
				}
			}
			mother = {
				if = {
					limit = {
						has_trait = towering
					}
					hgt_4_flag_tgr = yes
				}
				else_if = {
					limit = {
						has_trait = tall
					}
					hgt_3_flag_tgr = yes
				}
				else_if = {
					limit = {
						has_trait = short
					}
					hgt_2_flag_tgr = yes
				}
				else_if = {
					limit = {
						has_trait = tiny
					}
					hgt_1_flag_tgr = yes
				}
				else = {
					average_hgt_flag_tgr = yes
				}
			}
		}
		
		## 3. Punnett Square
		set_variable = { name = alleles value = 0 }
		
		if = {
		
			limit = {
				real_father = {
					has_character_flag = hgt_AA
				}
				mother = {
					has_character_flag = hgt_AA
				}
			}
			add_character_flag = hgt_AA
			change_variable = { name = alleles add = 2 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_AA
				}
				mother = {
					has_character_flag = hgt_Aa
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_AA
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Aa
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Aa
			}
			mother = {
				has_character_flag = hgt_AA
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_AA
			change_variable = { name = alleles add = 2 }

			}
			50 = {
			add_character_flag = hgt_Aa
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Aa
			}
			mother = {
				has_character_flag = hgt_Aa
			}
			}
			random_list = {
			25 = {
			add_character_flag = hgt_AA
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Aa
			change_variable = { name = alleles add = 1 }
			}
			25 = {
			add_character_flag = hgt_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_AA
			}
			mother = {
				has_character_flag = hgt_aa
			}
			}
			add_character_flag = hgt_Aa
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_aa
			}
			mother = {
				has_character_flag = hgt_AA
			}
			}
			add_character_flag = hgt_Aa
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Aa
			}
			mother = {
				has_character_flag = hgt_aa
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Aa
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_aa
			}
			mother = {
				has_character_flag = hgt_Aa
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Aa
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_aa
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_aa
			}
			mother = {
				has_character_flag = hgt_aa
			}
			}
			add_character_flag = hgt_aa
		}
		else = {
			add_character_flag = hgt_Aa
			change_variable = { name = alleles add = 1 }
		}
	
		if = {
		
			limit = {
				real_father = {
					has_character_flag = hgt_BB
				}
				mother = {
					has_character_flag = hgt_BB
				}
			}
			add_character_flag = hgt_BB
			change_variable = { name = alleles add = 2 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_BB
				}
				mother = {
					has_character_flag = hgt_Bb
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_BB
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Bb
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_Bb
				}
				mother = {
					has_character_flag = hgt_BB
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_BB
			change_variable = { name = alleles add = 2 }

			}
			50 = {
			add_character_flag = hgt_Bb
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_Bb
				}
				mother = {
					has_character_flag = hgt_Bb
				}
			}
			random_list = {
			25 = {
			add_character_flag = hgt_BB
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Bb
			change_variable = { name = alleles add = 1 }
			}
			25 = {
			add_character_flag = hgt_bb
			}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_BB
				}
				mother = {
					has_character_flag = hgt_bb
				}
			}
			add_character_flag = hgt_Bb
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_bb
				}
				mother = {
					has_character_flag = hgt_BB
				}
			}
			add_character_flag = hgt_Bb
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_Bb
				}
				mother = {
					has_character_flag = hgt_bb
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Bb
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_bb
			}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_bb
				}
				mother = {
					has_character_flag = hgt_Bb
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Bb
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_bb
			}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_bb
				}
				mother = {
					has_character_flag = hgt_bb
				}
			}
			add_character_flag = hgt_bb
		}
		else = {
			add_character_flag = hgt_Bb
			change_variable = { name = alleles add = 1 }
		}

		if = {
		
			limit = {
				real_father = {
					has_character_flag = hgt_CC
				}
				mother = {
					has_character_flag = hgt_CC
				}
			}
			add_character_flag = hgt_CC
			change_variable = { name = alleles add = 2 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_CC
				}
				mother = {
					has_character_flag = hgt_Cc
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_CC
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Cc
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_Cc
				}
				mother = {
					has_character_flag = hgt_CC
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_CC
			change_variable = { name = alleles add = 2 }

			}
			50 = {
			add_character_flag = hgt_Cc
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_Cc
				}
				mother = {
					has_character_flag = hgt_Cc
				}
			}
			random_list = {
			25 = {
			add_character_flag = hgt_CC
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Cc
			change_variable = { name = alleles add = 1 }
			}
			25 = {
			add_character_flag = hgt_cc
			}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_CC
				}
				mother = {
					has_character_flag = hgt_cc
				}
			}
			add_character_flag = hgt_Cc
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_cc
				}
				mother = {
					has_character_flag = hgt_CC
				}
			}
			add_character_flag = hgt_Cc
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_Cc
				}
				mother = {
					has_character_flag = hgt_cc
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Cc
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_cc
			}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_cc
				}
				mother = {
					has_character_flag = hgt_Cc
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Cc
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_cc
			}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_cc
				}
				mother = {
					has_character_flag = hgt_cc
				}
			}
			add_character_flag = hgt_cc
		}
		else = {
			add_character_flag = hgt_Cc
			change_variable = { name = alleles add = 1 }
		}

				if = {
		
			limit = {
				real_father = {
					has_character_flag = hgt_DD
				}
				mother = {
					has_character_flag = hgt_DD
				}
			}
			add_character_flag = hgt_DD
			change_variable = { name = alleles add = 2 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_DD
				}
				mother = {
					has_character_flag = hgt_Dd
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_DD
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Dd
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Dd
			}
			mother = {
				has_character_flag = hgt_DD
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_DD
			change_variable = { name = alleles add = 2 }

			}
			50 = {
			add_character_flag = hgt_Dd
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Dd
			}
			mother = {
				has_character_flag = hgt_Dd
			}
			}
			random_list = {
			25 = {
			add_character_flag = hgt_DD
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Dd
			change_variable = { name = alleles add = 1 }
			}
			25 = {
			add_character_flag = hgt_dd
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_DD
			}
			mother = {
				has_character_flag = hgt_dd
			}
			}
			add_character_flag = hgt_Dd
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_dd
			}
			mother = {
				has_character_flag = hgt_DD
			}
			}
			add_character_flag = hgt_Dd
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Dd
			}
			mother = {
				has_character_flag = hgt_dd
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Dd
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_dd
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_dd
			}
			mother = {
				has_character_flag = hgt_Dd
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Dd
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_dd
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_dd
			}
			mother = {
				has_character_flag = hgt_dd
			}
			}
			add_character_flag = hgt_dd
		}
		else = {
			add_character_flag = hgt_Dd
			change_variable = { name = alleles add = 1 }
		}

				if = {
		
			limit = {
				real_father = {
					has_character_flag = hgt_EE
				}
				mother = {
					has_character_flag = hgt_EE
				}
			}
			add_character_flag = hgt_EE
			change_variable = { name = alleles add = 2 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_EE
				}
				mother = {
					has_character_flag = hgt_Ee
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_EE
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Ee
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Ee
			}
			mother = {
				has_character_flag = hgt_EE
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_EE
			change_variable = { name = alleles add = 2 }

			}
			50 = {
			add_character_flag = hgt_Ee
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Ee
			}
			mother = {
				has_character_flag = hgt_Ee
			}
			}
			random_list = {
			25 = {
			add_character_flag = hgt_EE
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Ee
			change_variable = { name = alleles add = 1 }
			}
			25 = {
			add_character_flag = hgt_ee
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_EE
			}
			mother = {
				has_character_flag = hgt_ee
			}
			}
			add_character_flag = hgt_Ee
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_ee
			}
			mother = {
				has_character_flag = hgt_EE
			}
			}
			add_character_flag = hgt_Ee
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Ee
			}
			mother = {
				has_character_flag = hgt_ee
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Ee
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_ee
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_ee
			}
			mother = {
				has_character_flag = hgt_Ee
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Ee
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_ee
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_ee
			}
			mother = {
				has_character_flag = hgt_ee
			}
			}
			add_character_flag = hgt_ee
		}
		else = {
			add_character_flag = hgt_Ee
			change_variable = { name = alleles add = 1 }
		}


				if = {
		
			limit = {
				real_father = {
					has_character_flag = hgt_FF
				}
				mother = {
					has_character_flag = hgt_FF
				}
			}
			add_character_flag = hgt_FF
			change_variable = { name = alleles add = 2 }
		}
		else_if = {
			limit = {
				real_father = {
					has_character_flag = hgt_FF
				}
				mother = {
					has_character_flag = hgt_Ff
				}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_FF
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Ff
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Ff
			}
			mother = {
				has_character_flag = hgt_FF
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_FF
			change_variable = { name = alleles add = 2 }

			}
			50 = {
			add_character_flag = hgt_Ff
			change_variable = { name = alleles add = 1 }
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Ff
			}
			mother = {
				has_character_flag = hgt_Ff
			}
			}
			random_list = {
			25 = {
			add_character_flag = hgt_FF
			change_variable = { name = alleles add = 2 }
			}
			50 = {
			add_character_flag = hgt_Ff
			change_variable = { name = alleles add = 1 }
			}
			25 = {
			add_character_flag = hgt_ff
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_FF
			}
			mother = {
				has_character_flag = hgt_ff
			}
			}
			add_character_flag = hgt_Ff
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_ff
			}
			mother = {
				has_character_flag = hgt_FF
			}
			}
			add_character_flag = hgt_Ff
			change_variable = { name = alleles add = 1 }
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_Ff
			}
			mother = {
				has_character_flag = hgt_ff
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Ff
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_ff
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_ff
			}
			mother = {
				has_character_flag = hgt_Ff
			}
			}
			random_list = {
			50 = {
			add_character_flag = hgt_Ff
			change_variable = { name = alleles add = 1 }
			}
			50 = {
			add_character_flag = hgt_ff
			}
			}
		}
		else_if = {
		limit = {
			real_father = {
				has_character_flag = hgt_ff
			}
			mother = {
				has_character_flag = hgt_ff
			}
			}
			add_character_flag = hgt_ff
		}
		else = {
			add_character_flag = hgt_Ff
			change_variable = { name = alleles add = 1 }
		}


		#4. Phenotype to genotype conversion
		if = {
			limit = {
				var:alleles = 12
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
						has_trait = dwarf
						has_trait = giant
					}
				}
			}
			add_trait = towering
		}
		else_if = {
			limit = {
				var:alleles = 11
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
						has_trait = dwarf
						has_trait = giant
					}
				}
			}
			random_list = {
				85 = {
				add_trait = towering
				}
				15 = {
				add_trait = tall
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 10
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
						has_trait = dwarf
						has_trait = giant
					}
				}
			}
			random_list = {
				15 = {
				add_trait = towering
				}
				85 = {
				add_trait = tall
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 9
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
						has_trait = dwarf
						has_trait = giant
					}
				}
			}
			random_list = {
				20 = {
				add_trait = tall
				}
				70 = {
					add_character_flag = tallish
				}
				10 = {
					add_character_flag = tallish2
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 8
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
						has_trait = dwarf
						has_trait = giant
					}
				}
			}
			random_list = {
				60 = {
					add_character_flag = tallish2
				}
				40 = {
					add_character_flag = tallish3
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 7
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
						has_trait = dwarf
						has_trait = giant
					}
				}
			}
			random_list = {
				5 = {
					add_character_flag = tallish2
				}
				35 = {
					add_character_flag = tallish3
				}
				60 = {
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 6
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
						has_trait = dwarf
						has_trait = giant
					}
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 5
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_trait = dwarf
						has_trait = giant
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
					}
				}
			}
			random_list = {
				5 = {
					add_character_flag = shortish2
				}
				35 = {
					add_character_flag = shortish3
				}
				60 = {
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 4
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_trait = dwarf
						has_trait = giant
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
					}
				}
			}

			random_list = {
				50 = {
					add_character_flag = shortish2
				}
				50 = {
					add_character_flag = shortish3
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 3
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_trait = dwarf
						has_trait = giant
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
					}
				}
			}
			random_list = {
				15 = {
				add_trait = short
				}
				65 = {
					add_character_flag = shortish
				}
				20 = {
					add_character_flag = shortish2
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 2
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_trait = dwarf
						has_trait = giant
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
					}
				}
			}
			random_list = {
				10 = {
				add_trait = tiny
				}
				80 = {
				add_trait = short
				}
				10 = {
				add_character_flag = shortish
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 1
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_trait = dwarf
						has_trait = giant
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
					}
				}
			}
			random_list = {
				75 = {
				add_trait = tiny
				}
				25 = {
				add_trait = short
				}
			}
		}
		else_if = {
			limit = {
				var:alleles = 0
				NOT = {
					OR = {
						has_trait = towering
						has_trait = tall
						has_trait = tiny
						has_trait = short
						has_character_flag = tallish
						has_character_flag = shortish
						has_trait = dwarf
						has_trait = giant
						has_character_flag = tallish2
						has_character_flag = tallish3
						has_character_flag = shortish2
						has_character_flag = shortish3
					}
				}
			}
			add_trait = tiny
		}
		else = {
		}
	}
}

## HEMOPHILIA - X Linked Recessive. 2 alleles
IG.114 = {
	type = character_event
	hidden = yes

	immediate = {
		## 2. Initialization. Only executes if parents have no flags
		if = {
			limit = {
				real_father = {
					NOR = {
						has_character_flag = bleeder_AA
						has_character_flag = bleeder_Aa
						has_character_flag = bleeder_aa
					}
				}
			}
			real_father = {
				if = {
					limit = {
						has_trait = bleeder
					}
					add_character_flag = bleeder_aa
				}
				else = {
					random_list = {
						17 = {
							add_character_flag = bleeder_AA
						}
						3 = {
							add_character_flag = bleeder_Aa
						}
					}
				}
			}
		}
		if = {
			limit = {
				mother = {
					NOR = {
						has_character_flag = bleeder_AA
						has_character_flag = bleeder_Aa
						has_character_flag = bleeder_aa
						has_character_flag = bleeder_BB
						has_character_flag = bleeder_Bb
						has_character_flag = bleeder_bb
					}
				}
			}
			mother = {
				if = {
					limit = {
						has_trait = bleeder
					}
					add_character_flag = bleeder_aa
					add_character_flag = bleeder_bb
				}
				else = {
					random_list = {
						17 = {
							add_character_flag = bleeder_BB
						}
						3 = {
							add_character_flag = bleeder_Bb
						}
					}
					random_list = {
						17 = {
							add_character_flag = bleeder_AA
						}
						3 = {
							add_character_flag = bleeder_Aa
						}
					}
				}
			}
		}



		
		
		## 3. Punnett Square
		set_variable = { name = ralleles value = 0 }
		
		## For females
		if = {
			limit = {
				is_female = yes
			}
			if = {
				limit = {
					real_father = {
						has_character_flag = bleeder_AA
					}
					mother = {
						has_character_flag = bleeder_AA
					}
				}
				add_character_flag = bleeder_AA
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = bleeder_AA
					}
					mother = {
						has_character_flag = bleeder_Aa
					}
				}
				random_list = {
					50 = {
						add_character_flag = bleeder_AA
					}
					50 = {
					add_character_flag = bleeder_Aa
					}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = bleeder_Aa
				}
				mother = {
					has_character_flag = bleeder_AA
				}
				}
				random_list = {
					50 = {
						add_character_flag = bleeder_AA

					}
					50 = {
						add_character_flag = bleeder_Aa
					}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = bleeder_Aa
					}
					mother = {
						has_character_flag = bleeder_Aa
					}
				}
				random_list = {
					25 = {
						add_character_flag = bleeder_AA
					}
					50 = {
						add_character_flag = bleeder_Aa
					}
					25 = {
						add_character_flag = bleeder_aa
						change_variable = { name = ralleles add = 1 }
					}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = bleeder_AA
				}
				mother = {
					has_character_flag = bleeder_aa
				}
				}
				add_character_flag = bleeder_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = bleeder_aa
				}
				mother = {
					has_character_flag = bleeder_AA
				}
				}
				add_character_flag = bleeder_Aa
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = bleeder_Aa
				}
				mother = {
					has_character_flag = bleeder_aa
				}
				}
				random_list = {
				50 = {
				add_character_flag = bleeder_Aa
				}
				50 = {
				add_character_flag = bleeder_aa
				change_variable = { name = ralleles add = 1 }
				}
				}
			}
			else_if = {
				limit = {
					real_father = {
						has_character_flag = bleeder_aa
					}
					mother = {
						has_character_flag = bleeder_Aa
					}
				}
				random_list = {
					50 = {
						add_character_flag = bleeder_Aa
					}
					50 = {
						add_character_flag = bleeder_aa
						change_variable = { name = ralleles add = 1 }
					}
				}
			}
			else_if = {
			limit = {
				real_father = {
					has_character_flag = bleeder_aa
				}
				mother = {
					has_character_flag = bleeder_aa
				}
				}
				add_character_flag = bleeder_aa
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = bleeder_AA
			}

			if = {
				limit = {
					mother = {
						has_character_flag = bleeder_BB
					}
				}
				add_character_flag = bleeder_BB
				change_variable = { name = ralleles add = -1 }
			}
			else_if = {
				limit = {
					mother = {
						has_character_flag = bleeder_Bb
					}
				}
				add_character_flag = bleeder_Bb
				change_variable = { name = ralleles add = -1 }
			}
			else_if = {
				limit = {
					mother = {
						has_character_flag = bleeder_bb
					}
				}
				add_character_flag = bleeder_bb
			}
			else = {
				add_character_flag = bleeder_BB
				change_variable = { name = ralleles add = -1 }
			}
		}

		## A gene, for males

		if = {
			limit = {
				is_female = no
			}
			if = {
				limit = {
					mother = {
						has_character_flag = bleeder_AA
					}
				}
				add_character_flag = bleeder_AA
			}
			else_if = {
				limit = {
					mother = {
						has_character_flag = bleeder_Aa
					}
				}
				add_character_flag = bleeder_Aa
			}
			else_if = {
				limit = {
					mother = {
						has_character_flag = bleeder_aa
					}
				}
				add_character_flag = bleeder_aa
				change_variable = { name = ralleles add = 1 }
			}
			else = {
				add_character_flag = bleeder_AA
			}
		}


		## Mutation in A gene (very dangerous)
		if = {
			limit = {
				has_character_flag = bleeder_AA
			}
			random_list = {
				12 = {
					remove_character_flag = bleeder_AA
					add_character_flag = bleeder_Aa
				}
				992 = {

				}
			}
		}

		if = {
			limit = {
				has_character_flag = bleeder_Aa
			}
			random_list = {
				24 = {
					remove_character_flag = bleeder_Aa
					add_character_flag = bleeder_aa
					change_variable = { name = ralleles add = 1 }
				}
				980 = {

				}
			}
		}
		## Mutation in B gene (insignificant)
		if = {
			limit = {
				has_character_flag = bleeder_BB
			}
			random_list = {
				10 = {
					remove_character_flag = bleeder_Bb
					add_character_flag = bleeder_Bb
				}
				992 = {

				}
			}
		}

		if = {
			limit = {
				has_character_flag = bleeder_Bb
			}
			random_list = {
				20 = {
					remove_character_flag = bleeder_Bb
					add_character_flag = bleeder_bb
					change_variable = { name = ralleles add = 1 }
				}
				984 = {

				}
			}
		}


		#4. Phenotype to genotype conversion
		if = {
			limit = {
				is_female = no
				has_character_flag = bleeder_aa
				NOT = {
					has_trait = bleeder
				}
			}
			add_trait = bleeder
		}
		else_if = {
			limit = {
				is_female = yes
				has_character_flag = bleeder_aa
				has_character_flag = bleeder_bb
				NOT = {
					has_trait = bleeder
				}
			}
			add_trait = bleeder
		}
		else = {
		}
	}
}

## CANCER - Recessive


## BLINDNESS - Recessive

## DEAFNESS - Recessive

## TWIN EVENT
IG.200 = {
	type = character_event
	hidden = yes

	immediate = {
		random_sibling = {
				limit = {
					is_twin_of = ROOT
				}
				save_temporary_scope_as = twin_dna
			}
		if = {
			limit = {
				has_trait = twin
			}

			## First time you DONT want to copy
			if = {
				limit = {
					NOR = { 
						has_character_flag = twin_alleles_start
						scope:twin_dna = {
							has_character_flag = twin_alleles_start
							} 
						}
					NOT = { has_character_flag = twin_alleles_done }
				}
				add_character_flag = twin_alleles_start
			}
			## This only fires for second lad
			else_if = {
				limit = {
					NOT = { has_character_flag = twin_alleles_start }
					NOT = { has_character_flag = twin_alleles_done }
				}
				random_list = {
					80 = {
						## Identical Twins. Remove all flags, traits, and copy the twin
						delete_dna_flags = yes
						delete_char_traits = yes
						copy_twin_flags = yes
					}
					20 = {
						## Fraternal Twins
						## Do nothing
						add_character_flag = fraternal_twin
					}
				}
				add_character_flag = twin_alleles_done
				scope:twin_dna = {
					add_character_flag = twin_alleles_done
				}
			}
			else = {

			}
		}
		
	}
}


## MAINTENANCE
IG.201 = {
	type = empty
	hidden = yes

	immediate = {
		## real_father
		every_living_character = {
			## Only give these traits to unimportant characters
			if = {
				limit = {
					is_ai = yes
				}
				## CHECK FOR ALBINO, SCALY, SPINDLY, DWARF, GIANT, BLEEDER
				if = {
					limit = {
						has_trait = albino
						NOT = {
							has_character_flag = albino_aa
						}
					}
					remove_character_flag = albino_AA
					remove_character_flag = albino_Aa
					add_character_flag = albino_aa
				}

				if = {
					limit = {
						has_trait = scaly
						has_character_flag = scl_aa
					}
					remove_character_flag = scl_aa
					add_character_flag = scl_Aa
				}

				if = {
					limit = {
						has_trait = dwarf
						has_character_flag = dwarf_aa
					}
					remove_character_flag = dwarf_aa
					add_character_flag = dwarf_Aa
				}

				if = {
					limit = {
						has_trait = giant
						has_character_flag = giant_aa
					}
					remove_character_flag = giant_aa
					add_character_flag = giant_Aa
				}

				if = {
					limit = {
						has_trait = spindly
						has_character_flag = spindly_aa
					}
					remove_character_flag = spindly_aa
					add_character_flag = spindly_Aa
				}

				if = {
					limit = {
						has_trait = bleeder
						is_female = yes
						NOT = {
							has_character_flag = bleeder_aa
							has_character_flag = bleeder_bb
						}
					}
					remove_character_flag = bleeder_AA
					remove_character_flag = bleeder_BB
					remove_character_flag = bleeder_Aa
					remove_character_flag = bleeder_Bb
					add_character_flag = bleeder_bb
					add_character_flag = bleeder_aa
				}

				if = {
					limit = {
						has_trait = bleeder
						is_female = no
						NOT = {
							has_character_flag = bleeder_aa
						}
					}
					remove_character_flag = bleeder_AA
					remove_character_flag = bleeder_Aa
					add_character_flag = bleeder_aa
				}
			}
		}
	}
}

### UNTIL PROPERLY ADDED TO THE SYSTEM, NEED TO DO DEPRESSED, LUNATIC, POSSESSED, FECUND, INFERTILE

IG.202 = {
	type = character_event
	hidden = yes

	immediate = {
		if = {
			limit = {
				real_father = {
					has_trait = depressed_genetic
				}
				mother = {
					has_trait = depressed_genetic
				}
			}
			random_list = {
				75 = {
					add_trait = depressed_genetic
				}
				25 = {
				}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_trait = depressed_genetic
				}
			}
			random_list = {
				25 = {
					add_trait = depressed_genetic
				}
				75 = {
				}
			}
		}
		else_if = {
			limit = {
				mother = {
					has_trait = depressed_genetic
				}
			}
			random_list = {
				25 = {
					add_trait = depressed_genetic
				}
				75 = {
					
				}
			}
		}
		else = {
		}

		if = {
			limit = {
				real_father = {
					has_trait = lunatic_genetic
				}
				mother = {
					has_trait = lunatic_genetic
				}
			}
			random_list = {
				75 = {
					add_trait = lunatic_genetic
				}
				25 = {
				}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_trait = lunatic_genetic
				}
			}
			random_list = {
				25 = {
					add_trait = lunatic_genetic
				}
				75 = {
				}
			}
		}
		else_if = {
			limit = {
				mother = {
					has_trait = lunatic_genetic
				}
			}
			random_list = {
				25 = {
					add_trait = lunatic_genetic
				}
				75 = {
					
				}
			}
		}
		else = {	
		}


		if = {
			limit = {
				real_father = {
					has_trait = possessed_genetic
				}
				mother = {
					has_trait = possessed_genetic
				}
			}
			random_list = {
				75 = {
					add_trait = possessed_genetic
				}
				25 = {
				}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_trait = possessed_genetic
				}
			}
			random_list = {
				25 = {
					add_trait = possessed_genetic
				}
				75 = {
				}
			}
		}
		else_if = {
			limit = {
				mother = {
					has_trait = possessed_genetic
				}
			}
			random_list = {
				25 = {
					add_trait = possessed_genetic
				}
				75 = {
					
				}
			}
		}
		else = {
			}


		if = {
			limit = {
				real_father = {
					has_trait = fecund
				}
				mother = {
					has_trait = fecund
				}
			}
			random_list = {
				75 = {
					add_trait = fecund
				}
				25 = {
				}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_trait = fecund
				}
			}
			random_list = {
				25 = {
					add_trait = fecund
				}
				75 = {
				}
			}
		}
		else_if = {
			limit = {
				mother = {
					has_trait = fecund
				}
			}
			random_list = {
				25 = {
					add_trait = fecund
				}
				75 = {
					
				}
			}
		}
		else = {	
		}

		if = {
			limit = {
				real_father = {
					has_trait = infertile
				}
				mother = {
					has_trait = infertile
				}
			}
			random_list = {
				75 = {
					add_trait = infertile
				}
				25 = {
				}
			}
		}
		else_if = {
			limit = {
				real_father = {
					has_trait = infertile
				}
			}
			random_list = {
				25 = {
					add_trait = infertile
				}
				75 = {
				}
			}
		}
		else_if = {
			limit = {
				mother = {
					has_trait = infertile
				}
			}
			random_list = {
				25 = {
					add_trait = infertile
				}
				75 = {
					
				}
			}
		}
		else = {	
		}
	}
}