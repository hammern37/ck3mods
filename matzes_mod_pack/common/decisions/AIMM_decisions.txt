aimm_marry_matrilineal_lowborn ={
	title="贯彻落实封建主义等级秩序"
	desc="P社懒驴还不修BUG"
	confirm_text="拯救弱智AI"
	ai_check_interval = 6
	is_shown = {
		is_landed = yes
		highest_held_title_tier >= tier_count
		any_courtier = {
			is_female = yes
			is_lowborn = no
			is_married = yes
			matrilinear_marriage = no
			any_spouse = {
				is_lowborn = yes
			}
		}
	}
	is_valid = {
	}
	effect={
		every_courtier = {
			limit = {
				is_female = yes
				is_lowborn = no
				is_married = yes
				matrilinear_marriage = no
			}
			every_spouse = {
				limit = {
					is_lowborn = yes
				}
				divorce = prev
				marry_matrilineal = prev
			}
			every_child = {
				limit = {
					is_lowborn = yes
				}
				set_house = prev.house
				set_character_faith = prev.faith
				set_culture = prev.culture
			}
		}
	}
	ai_will_do = {
		base = 100
	}
}

aimm_marry_matrilineal_female_dominated ={
	title="转换为入赘婚姻"
	desc="P社懒驴还不修BUG"
	confirm_text="拯救弱智AI"
	ai_check_interval = 6
	is_shown = {
		is_female = yes
		is_landed = yes
		highest_held_title_tier >= tier_count
		is_married = yes
		age < 50
		OR = {
			faith = { has_doctrine = doctrine_gender_female_dominated }
			faith = { has_doctrine = doctrine_gender_equal_female_preference }
		}
		any_spouse = {
			NOT = {
				has_opinion_modifier = {
					modifier = matrilineal_set
					target = scope:root
				}
			}
		}
	}
	is_valid = {
	}
	effect={
		every_spouse = {
			limit = {
				NOT = {
					has_opinion_modifier = {
						modifier = matrilineal_set
						target = scope:root
					}
				}
			}
			divorce = ROOT
			marry_matrilineal = ROOT
			add_opinion = {
				target = scope:root
				modifier = matrilineal_set
			}
		}
		every_child = {
			limit = {
				NOT = {
					house = root.house
				}
				age < 16
			}
			set_house = root.house
			set_character_faith = root.faith
			set_culture = root.culture
		}
	}
	ai_will_do = {
		base = 100
	}
}

aimm_marry_matrilineal_equal ={
	title="转换为入赘婚姻"
	desc="P社懒驴还不修BUG"
	confirm_text="拯救弱智AI"
	ai_check_interval = 6
	is_shown = {
		is_female = yes
		is_landed = yes
		highest_held_title_tier >= tier_count
		is_married = yes
		age < 50
		faith = { has_doctrine = doctrine_gender_equal }
		matrilinear_marriage = no
	}
	is_valid = {
		trigger_if = {
			limit = {
				any_spouse = {
					OR = {
						any_close_or_extended_family_member = {
							highest_held_title_tier >= tier_kingdom
						}
						highest_held_title_tier >= tier_kingdom
					}
				}
			}
			OR = {
				highest_held_title_tier >= tier_kingdom
				any_close_or_extended_family_member = {
					highest_held_title_tier >= tier_kingdom
				}
			}
		}
		any_spouse = {
			highest_held_title_tier < root.highest_held_title_tier
			OR = {
				dynasty_prestige_level < root.dynasty_prestige_level
				AND = {
					dynasty_prestige_level = root.dynasty_prestige_level
					any_close_or_extended_family_member = {
						highest_held_title_tier < root.highest_held_title_tier
					}
				}
				AND = {
					dynasty_prestige_level = root.dynasty_prestige_level
					any_close_or_extended_family_member = {
						highest_held_title_tier = root.highest_held_title_tier
						prestige_level < root.prestige_level
					}
				}
			}
		}
		
	}
	effect={
		every_spouse = {
			divorce = ROOT
			marry_matrilineal = ROOT
		}
		every_child = {
			limit = {
				NOT = {
					house = root.house
				}
				age < 6
			}
			set_house = root.house
			set_character_faith = root.faith
			set_culture = root.culture
		}
	}
	ai_will_do = {
		base = 100
	}
}

aimm_marry_matrilineal_male_dominated ={
	title="转换为入赘婚姻"
	desc="P社懒驴还不修BUG"
	confirm_text="拯救弱智AI"
	ai_check_interval = 6
	is_shown = {
		is_female = yes
		is_landed = yes
		highest_held_title_tier >= tier_count
		is_married = yes
		age < 50
		OR = {
			faith = { has_doctrine = doctrine_gender_male_dominated }
			faith = { has_doctrine = doctrine_gender_equal_male_preference }
		}
		matrilinear_marriage = no
	}
	is_valid = {
		trigger_if = {
			limit = {
				any_spouse = {
					OR = {
						any_close_or_extended_family_member = {
							highest_held_title_tier >= tier_kingdom
						}
						highest_held_title_tier >= tier_kingdom
					}
				}
			}
			OR = {
				highest_held_title_tier >= tier_kingdom
				any_close_or_extended_family_member = {
					highest_held_title_tier >= tier_kingdom
				}
			}
		}
		any_spouse = {
			highest_held_title_tier < root.highest_held_title_tier
			OR = {
				dynasty_prestige_level < root.dynasty_prestige_level
				AND = {
					dynasty_prestige_level = root.dynasty_prestige_level
					any_close_or_extended_family_member = {
						highest_held_title_tier < root.highest_held_title_tier
					}
				}
				AND = {
					dynasty_prestige_level = root.dynasty_prestige_level
					any_close_or_extended_family_member = {
						highest_held_title_tier = root.highest_held_title_tier
						prestige_level < root.prestige_level
					}
				}
			}
		}
		
	}
	effect={
		every_spouse = {
			divorce = ROOT
			marry_matrilineal = ROOT
		}
		every_child = {
			limit = {
				NOT = {
					house = root.house
				}
				age < 3
			}
			set_house = root.house
			set_character_faith = root.faith
			set_culture = root.culture
		}
	}
	ai_will_do = {
		base = 100
	}
}

aimm_female_dominated_grandchild_adopted ={
	title="收养外孙"
	desc="P社懒驴还不修BUG"
	confirm_text="拯救弱智AI"
	ai_check_interval = 12
	is_shown = {
		is_landed = yes
		highest_held_title_tier >= tier_count
		OR = {
			faith = { has_doctrine = doctrine_gender_female_dominated }
			faith = { has_doctrine = doctrine_gender_equal_female_preference }
		}
		any_child = {
			is_female = yes
			is_landed = no
			is_married = yes
			matrilinear_marriage = no
			is_courtier_of = root
			any_child = {
				age < 16
				NOT = { house = prev.house }
			}
		}
	}
	is_valid = {
	}
	effect={
		every_child = {
			limit = {
				is_female = yes
				is_landed = no
				is_married = yes
				matrilinear_marriage = no
				is_courtier_of = root
			}
			every_child = {
				limit = {
					age < 16
					NOT = { house = prev.house }
				}
				set_house = prev.house
				set_character_faith = prev.faith
				set_culture = prev.culture
			}
			every_spouse = {
				divorce = prev
				marry_matrilineal = prev
			}
		}
	}
	ai_will_do = {
		base = 100
	}
}

aimm_equal_grandchild_adopted ={
	title="收养外孙"
	desc="P社懒驴还不修BUG"
	confirm_text="拯救弱智AI"
	ai_check_interval = 12
	is_shown = {
		is_landed = yes
		highest_held_title_tier >= tier_count
		faith = { has_doctrine = doctrine_gender_equal }
		any_heir = {
			is_female = yes
			is_landed = no
			is_married = yes
			matrilinear_marriage = no
			is_courtier_of = root
			any_child = {
				age < 6
				NOT = { house = prev.house }
			}
		}
	}
	is_valid = {
	}
	effect={
		every_heir = {
			limit = {
				is_female = yes
				is_landed = no
				is_married = yes
				matrilinear_marriage = no
				is_courtier_of = root
			}
			every_child = {
				limit = {
					age < 6
					NOT = { house = prev.house }
				}
				set_house = prev.house
				set_character_faith = prev.faith
				set_culture = prev.culture
			}
			every_spouse = {
				divorce = prev
				marry_matrilineal = prev
			}
		}
	}
	ai_will_do = {
		base = 100
	}
}

aimm_male_dominated_grandchild_adopted ={
	title="收养外孙"
	desc="P社懒驴还不修BUG"
	confirm_text="拯救弱智AI"
	ai_check_interval = 12
	is_shown = {
		is_landed = yes
		highest_held_title_tier >= tier_count
		OR = {
			faith = { has_doctrine = doctrine_gender_male_dominated }
			faith = { has_doctrine = doctrine_gender_equal_male_preference }
		}
		any_heir = {
			is_female = yes
			is_landed = no
			is_married = yes
			matrilinear_marriage = no
			is_courtier_of = root
			any_child = {
				age < 3
				NOT = { house = prev.house }
			}
		}
	}
	is_valid = {
	}
	effect={
		every_heir = {
			limit = {
				is_female = yes
				is_landed = no
				is_married = yes
				matrilinear_marriage = no
				is_courtier_of = root
			}
			every_child = {
				limit = {
					age < 3
					NOT = { house = prev.house }
				}
				set_house = prev.house
				set_character_faith = prev.faith
				set_culture = prev.culture
			}
			every_spouse = {
				divorce = prev
				marry_matrilineal = prev
			}
		}
	}
	ai_will_do = {
		base = 100
	}
}

aimm_female_dominated_nibling_adopted ={
	title="收养外甥"
	desc="P社懒驴还不修BUG"
	confirm_text="拯救弱智AI"
	ai_check_interval = 12
	is_shown = {
		is_landed = yes
		highest_held_title_tier >= tier_count
		OR = {
			faith = { has_doctrine = doctrine_gender_female_dominated }
			faith = { has_doctrine = doctrine_gender_equal_female_preference }
		}
		any_close_family_member = {
			is_sibling_of = root
			is_female = yes
			is_landed = no
			is_married = yes
			matrilinear_marriage = no
			is_courtier_of = root
			any_child = {
				age < 16
				NOT = { house = prev.house }
			}
		}
	}
	is_valid = {
	}
	effect={
		every_close_family_member = {
			limit = {
				is_sibling_of = root
				is_female = yes
				is_landed = no
				is_married = yes
				matrilinear_marriage = no
				is_courtier_of = root
			}
			every_child = {
				limit = {
					age < 16
					NOT = { house = prev.house }
				}
				set_house = prev.house
				set_character_faith = prev.faith
				set_culture = prev.culture
			}
			every_spouse = {
				divorce = prev
				marry_matrilineal = prev
			}
		}
	}
	ai_will_do = {
		base = 100
	}
}

aimm_equal_nibling_adopted ={
	title="收养外甥"
	desc="P社懒驴还不修BUG"
	confirm_text="拯救弱智AI"
	ai_check_interval = 12
	is_shown = {
		is_landed = yes
		highest_held_title_tier >= tier_count
		faith = { has_doctrine = doctrine_gender_equal }
		any_close_family_member = {
			is_sibling_of = root
			is_female = yes
			is_landed = no
			is_married = yes
			matrilinear_marriage = no
			is_courtier_of = root
			any_child = {
				age < 6
				NOT = { house = prev.house }
			}
		}
	}
	is_valid = {
	}
	effect={
		every_close_family_member = {
			limit = {
				is_sibling_of = root
				is_female = yes
				is_landed = no
				is_married = yes
				matrilinear_marriage = no
				is_courtier_of = root
			}
			every_child = {
				limit = {
					age < 6
					NOT = { house = prev.house }
				}
				set_house = prev.house
				set_character_faith = prev.faith
				set_culture = prev.culture
			}
			every_spouse = {
				divorce = prev
				marry_matrilineal = prev
			}
		}
	}
	ai_will_do = {
		base = 100
	}
}

aimm_male_dominated_nibling_adopted ={
	title="收养外甥"
	desc="P社懒驴还不修BUG"
	confirm_text="拯救弱智AI"
	ai_check_interval = 12
	is_shown = {
		is_landed = yes
		highest_held_title_tier >= tier_count
		OR = {
			faith = { has_doctrine = doctrine_gender_male_dominated }
			faith = { has_doctrine = doctrine_gender_equal_male_preference }
		}
		any_close_family_member = {
			is_sibling_of = root
			is_female = yes
			is_landed = no
			is_married = yes
			matrilinear_marriage = no
			is_courtier_of = root
			any_child = {
				age < 3
				NOT = { house = prev.house }
			}
		}
	}
	is_valid = {
	}
	effect={
		every_close_family_member = {
			limit = {
				is_sibling_of = root
				is_female = yes
				is_landed = no
				is_married = yes
				matrilinear_marriage = no
				is_courtier_of = root
			}
			every_child = {
				limit = {
					age < 3
					NOT = { house = prev.house }
				}
				set_house = prev.house
				set_character_faith = prev.faith
				set_culture = prev.culture
			}
			every_spouse = {
				divorce = prev
				marry_matrilineal = prev
			}
		}
	}
	ai_will_do = {
		base = 100
	}
}